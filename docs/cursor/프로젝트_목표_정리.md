# í”„ë¡œì íŠ¸ ëª©í‘œ ì •ë¦¬ (ìµœì¢…ë³¸ - 8GB RAM ê²½ëŸ‰ ë²„ì „)

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

REST APIì™€ GraphQL Federationì˜ ì„±ëŠ¥ì„ **ì‹¤ì œ í™˜ê²½ê³¼ ìœ ì‚¬í•˜ê²Œ** ë¹„êµí•˜ëŠ” ë²¤ì¹˜ë§ˆí¬ í”„ë¡œì íŠ¸

> ğŸ’» **ê°œë°œ í™˜ê²½**: 8GB RAM ê¸°ì¤€ ê²½ëŸ‰ êµ¬ì„±
> ğŸ“¦ **ì»¨í…Œì´ë„ˆ**: 12ê°œ (ì´ ë©”ëª¨ë¦¬ ~6GB)
> ğŸ¯ **ëª©í‘œ**: ì •ëŸ‰ì  ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •

## ğŸ¯ í•µì‹¬ ëª©í‘œ

### 1. ì„±ëŠ¥ ë¹„êµ ëŒ€ìƒ
- **REST API** (NGINX Gateway + ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤)
- **GraphQL Federation** (Apollo Router + Subgraphs)

### 2. ì¸¡ì •í•˜ë ¤ëŠ” ë©”íŠ¸ë¦­
- **ì²˜ë¦¬ëŸ‰ (TPS/RPS)**: ì´ˆë‹¹ 100, 300, 500 ìš”ì²­ ì²˜ë¦¬ ëŠ¥ë ¥
- **ì‘ë‹µ ì‹œê°„**: P50, P95, P99 ë ˆì´í„´ì‹œ
- **ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥ **:
  - CPU ì‚¬ìš©ë¥  (Gateway/Router ë° ì„œë¹„ìŠ¤ë³„)
  - Memory ì‚¬ìš©ë¥ 
  - Network I/O
- **ì—ëŸ¬ìœ¨**: ë¶€í•˜ ì¦ê°€ ì‹œ ì‹¤íŒ¨ìœ¨

> âš ï¸ **ê²½ëŸ‰ ë²„ì „ ì œí•œ**: ìµœëŒ€ 500 RPSê¹Œì§€ í…ŒìŠ¤íŠ¸ (8GB RAM í™˜ê²½)

### 3. í…ŒìŠ¤íŠ¸ ì•„í‚¤í…ì²˜

#### ë„ë©”ì¸: ë¡œë´‡ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ
- **User Service**: 100ëª…ì˜ ìš´ì˜ì ì •ë³´
- **Robot Service**: 200ëŒ€ì˜ ë¡œë´‡ ì •ë³´ + í…”ë ˆë©”íŠ¸ë¦¬
- **Site Service**: 5ê°œì˜ í˜„ì¥ ì •ë³´

#### ë°ì´í„° ì €ì¥ ë°©ì‹
- âŒ ë³„ë„ Mock ì„œë²„ ì‚¬ìš© ì•ˆí•¨
- âŒ ì‹¤ì œ DB ì‚¬ìš© ì•ˆí•¨ (ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì•„ë‹˜)
- âœ… **ê° ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ In-memory JSON ë°ì´í„° ì§ì ‘ ë³´ìœ **
- âœ… ê³ ì •ëœ latencyë¡œ DB I/O ì‹œë®¬ë ˆì´ì…˜ (`asyncio.sleep`)

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ (4ê°€ì§€)

### API-1: Baseline Performance (ë‹¨ìˆœ ì¡°íšŒ)
```
ëª©ì : Gateway/Routerì˜ ìˆœìˆ˜ ì˜¤ë²„í—¤ë“œ ì¸¡ì •
REST:    GET /api/v1/users
GraphQL: query { users { id name email role } }
```
- ì˜ˆìƒ: REST ìŠ¹ë¦¬ (ë‹¨ìˆœ í”„ë¡ì‹œ vs íŒŒì‹±/ê²€ì¦ ì˜¤ë²„í—¤ë“œ)

### API-2: Cross-Service Join (1-hop ì˜ì¡´ì„±)
```
ëª©ì : ë³‘ë ¬ ì²˜ë¦¬ íš¨ìœ¨ì„± ë¹„êµ
REST:    GET /api/v1/robots/{id}/details
GraphQL: query { robot(id: $id) { operator { name } site { name } } }
```
- REST: ìˆœì°¨ í˜¸ì¶œ (Robot â†’ User â†’ Site)
- GraphQL: ë³‘ë ¬ í˜¸ì¶œ (Routerê°€ ìë™ ìµœì í™”)
- ì˜ˆìƒ: ë¹„ë“±í•˜ì§€ë§Œ GraphQLì´ ë³‘ë ¬ì„±ìœ¼ë¡œ ë¯¸ì„¸í•˜ê²Œ ìœ ë¦¬

### API-3: N+1 Problem (ë³µì¡í•œ ì¤‘ì²© ì¿¼ë¦¬)
```
ëª©ì : Batching íš¨ìœ¨ì„±ê³¼ ê°œë°œ ë³µì¡ë„ ë¹„êµ
REST:    GET /api/v1/sites/{id}/dashboard (40ëŒ€ ë¡œë´‡)
GraphQL: query { site(id: $id) { robots { operator { name } telemetry { cpu } } } }
```
- REST Naive: 40ë²ˆ ë°˜ë³µ í˜¸ì¶œ â†’ 600ms+
- REST Optimized: Batch endpoint ì§ì ‘ êµ¬í˜„ í•„ìš”
- GraphQL: DataLoaderê°€ ìë™ batching
- ì˜ˆìƒ: GraphQL ìŠ¹ë¦¬ (ìë™í™” + ê°œë°œ í¸ì˜ì„±)

### API-4: Complex Aggregation (ë‹¤ì¸µ ì§‘ê³„)
```
ëª©ì : Query Planning ì˜¤ë²„í—¤ë“œì™€ ê³ ë¶€í•˜ í™•ì¥ì„±
REST:    GET /api/v1/monitoring/overview
GraphQL: query { monitoringOverview { siteStats topOperators recentAlerts } }
```
- GraphQLì˜ Query Planningì´ ë³µì¡í•œ ì¿¼ë¦¬ì—ì„œ ë³‘ëª© ê°€ëŠ¥
- ì˜ˆìƒ: Low loadì—ì„œ ë¹„ë“±, High loadì—ì„œ REST ìŠ¹ë¦¬

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ ì„œë¹„ìŠ¤
- **REST**: FastAPI + NGINX
- **GraphQL**: Strawberry (FastAPI) + Apollo Router

### ë¶€í•˜ í…ŒìŠ¤íŠ¸
- **Locust**: Built-in Web UIë¡œ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
  - RPS ê¸°ë°˜ í…ŒìŠ¤íŠ¸ (constant_throughput)
  - Master-Worker ë¶„ì‚° êµ¬ì„±

### ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ
- **Prometheus**: ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- **Grafana**: ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ ì‹œê°í™”
- **Tempo**: ë¶„ì‚° ì¶”ì  (Tracing)
- **cAdvisor**: ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§

## ğŸ“Š í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ê³„íš (ê²½ëŸ‰ ë²„ì „)

### Phaseë³„ ë¶€í•˜ ì‹œë‚˜ë¦¬ì˜¤
| Phase | RPS Target | Virtual Users | Duration | ëª©ì  |
|-------|-----------|---------------|----------|------|
| Phase 1 | 100 RPS | 100 | 3ë¶„ | Baseline ì„±ëŠ¥ |
| Phase 2 | 300 RPS | 300 | 5ë¶„ | Medium load |
| Phase 3 | 500 RPS | 500 | 5ë¶„ | High load (ìµœëŒ€) |

> ğŸ“ **ì´ í…ŒìŠ¤íŠ¸ ì‹œê°„**: 13ë¶„ + Warm-up 2ë¶„ = 15ë¶„

### Locust ì„¤ì •
- `wait_time = constant_throughput(1)`: ê° ìœ ì €ê°€ ì´ˆë‹¹ 1íšŒ ìš”ì²­
- 500 users = 500 RPS (ê²½ëŸ‰ ë²„ì „ ìµœëŒ€)
- APIë³„ ê°€ì¤‘ì¹˜: API-1(50%), API-2(30%), API-3(15%), API-4(5%)

### ìˆœì°¨ í…ŒìŠ¤íŠ¸ ì „ëµ (ë©”ëª¨ë¦¬ ì ˆì•½)

**ë°©ë²• 1: ë™ì‹œ ì‹¤í–‰** (6GB ë©”ëª¨ë¦¬)
```bash
docker-compose -f docker-compose.lite.yml up -d
# RESTì™€ GraphQL ë™ì‹œ ì‹¤í–‰ â†’ ì§ì ‘ ë¹„êµ
```

**ë°©ë²• 2: ìˆœì°¨ ì‹¤í–‰** (4GB ë©”ëª¨ë¦¬ë¡œ ì¶©ë¶„)
```bash
# 1. RESTë§Œ ì‹¤í–‰ â†’ í…ŒìŠ¤íŠ¸ â†’ ê²°ê³¼ ì €ì¥
# 2. REST ì¤‘ì§€, GraphQL ì‹¤í–‰ â†’ í…ŒìŠ¤íŠ¸ â†’ ê²°ê³¼ ì €ì¥
# 3. ê²°ê³¼ ë¹„êµ
```

## ğŸ¯ ì˜ˆìƒ ê²°ê³¼ (ê²½ëŸ‰ ë²„ì „)

### RPSë³„ ìŠ¹ì ì˜ˆì¸¡
| RPS | API-1 | API-2 | API-3 | API-4 | Overall |
|-----|-------|-------|-------|-------|---------|
| 100 | REST | ë¹„ë“± | GraphQL | ë¹„ë“± | ë¹„ë“± |
| 300 | REST | GraphQL | GraphQL | REST | GraphQL |
| 500 | REST | GraphQL | GraphQL | REST | ë¹„ë“± |

> ğŸ“Š **ê²½ëŸ‰ ë²„ì „ íŠ¹ì§•**: ë‚®ì€ ë¶€í•˜ì—ì„œ GraphQLì˜ ì¥ì (ìë™ batching) ë” ì˜ ë“œëŸ¬ë‚¨

### ì˜ì‚¬ê²°ì • ê¸°ì¤€

#### GraphQL ì„ íƒ ì¡°ê±´
- âœ… TPS < 500
- âœ… N+1 íŒ¨í„´ì´ ë§ì€ ê²½ìš° (API-3 ìœ í˜• 30% ì´ìƒ)
- âœ… í´ë¼ì´ì–¸íŠ¸ê°€ ë‹¤ì–‘í•œ ë°ì´í„° ì¡°í•© ìš”êµ¬
- âœ… í”„ë¡ íŠ¸ì—”ë“œê°€ ë°±ì—”ë“œ ìˆ˜ì • ì—†ì´ ë°ì´í„° ì œì–´ í•„ìš”
- âœ… Over-fetching ë¬¸ì œ (ëª¨ë°”ì¼ ë°ì´í„° ë¹„ìš©)

#### REST ì„ íƒ ì¡°ê±´
- âœ… TPS > 1000 (ë†’ì€ ì²˜ë¦¬ëŸ‰ í•„ìš”)
- âœ… ë‹¨ìˆœí•˜ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•œ API
- âœ… ë³µì¡í•œ aggregationì´ ë§ìŒ (API-4 ìœ í˜• 30% ì´ìƒ)
- âœ… ì¸í”„ë¼ ë¹„ìš© ìµœì†Œí™”
- âœ… ë ˆê±°ì‹œ ì‹œìŠ¤í…œ í†µí•©

#### í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼
- Public API: GraphQL (í´ë¼ì´ì–¸íŠ¸ ìœ ì—°ì„±)
- Internal API: REST/gRPC (ì„±ëŠ¥ ì¤‘ì‹¬)
- Read-heavy: GraphQL
- Write-heavy: REST

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° (V2 - ì™„ì „ ë¶„ë¦¬)

```
graph-rest-preform/
â”‚
â”œâ”€â”€ rest/                            # REST ì•„í‚¤í…ì²˜ (ë¹„êµìš©)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ user-service/
â”‚   â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ main.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ models.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ data.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ config.py
â”‚   â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”‚   â””â”€â”€ requirements.txt
â”‚   â”‚   â”œâ”€â”€ robot-service/
â”‚   â”‚   â””â”€â”€ site-service/
â”‚   â”œâ”€â”€ gateway/
â”‚   â”‚   â””â”€â”€ nginx.conf
â”‚   â””â”€â”€ docker-compose.yml           # REST ì „ìš©
â”‚
â”œâ”€â”€ graphql/                         # GraphQL ì•„í‚¤í…ì²˜ (í”„ë¡œë•ì…˜ ë² ì´ìŠ¤)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ user-service/
â”‚   â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ main.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ schema/          # GraphQL Layer
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ types.py
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ queries.py
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ mutations.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ models/          # Domain Models
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ data/            # Repository Pattern
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ core/            # Config, Logging
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”‚   â”‚   â””â”€â”€ pyproject.toml
â”‚   â”‚   â”œâ”€â”€ robot-service/           # DataLoader í¬í•¨
â”‚   â”‚   â””â”€â”€ site-service/
â”‚   â”œâ”€â”€ gateway/
â”‚   â”‚   â”œâ”€â”€ router.yaml              # Apollo Router
â”‚   â”‚   â””â”€â”€ supergraph.graphql
â”‚   â””â”€â”€ docker-compose.yml           # GraphQL ì „ìš©
â”‚
â”œâ”€â”€ monitoring/                      # ê³µí†µ ëª¨ë‹ˆí„°ë§
â”‚   â”œâ”€â”€ prometheus/
â”‚   â”œâ”€â”€ grafana/
â”‚   â””â”€â”€ docker-compose.monitoring.yml
â”‚
â”œâ”€â”€ load-test/                       # ê³µí†µ ë¶€í•˜ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ locustfile_rest.py
â”‚   â”œâ”€â”€ locustfile_graphql.py
â”‚   â””â”€â”€ docker-compose.loadtest.yml
â”‚
â”œâ”€â”€ scripts/                         # ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ start-rest.sh
â”‚   â”œâ”€â”€ start-graphql.sh
â”‚   â””â”€â”€ start-monitoring.sh
â”‚
â”œâ”€â”€ docker-compose.full.yml          # ì „ì²´ í†µí•©
â””â”€â”€ docs/
    â””â”€â”€ cursor/
        â”œâ”€â”€ í”„ë¡œì íŠ¸_ëª©í‘œ_ì •ë¦¬.md
        â”œâ”€â”€ API-ì„¤ê³„-ìƒì„¸.md
        â””â”€â”€ í”„ë¡œì íŠ¸_êµ¬ì¡°_v2.md
```

### ğŸ”‘ í•µì‹¬ êµ¬ì¡° ì„¤ëª…

#### 1. ì™„ì „ ë¶„ë¦¬ ì•„í‚¤í…ì²˜
```
RESTì™€ GraphQL ì™„ì „íˆ ë…ë¦½:
âœ… ê°ì ë””ë ‰í† ë¦¬ ë¶„ë¦¬
âœ… ì˜ì¡´ì„± ì—†ìŒ
âœ… ë…ë¦½ ì‹¤í–‰ ê°€ëŠ¥
âœ… GraphQLì„ í”„ë¡œë•ì…˜ ë² ì´ìŠ¤ë¡œ ì‚¬ìš© ê°€ëŠ¥
```

#### 2. GraphQL í”„ë¡œë•ì…˜ ìˆ˜ì¤€ êµ¬ì¡°
```
ê° ì„œë¹„ìŠ¤ ë ˆì´ì–´:
schema/    â†’ Presentation (GraphQL)
models/    â†’ Domain (Business Logic)
data/      â†’ Data Access (Repository)
core/      â†’ Config, Logging
utils/     â†’ Helpers
```

#### 3. Docker Compose ë¶„ë¦¬
```
rest/docker-compose.yml         â†’ REST 3ê°œ ì„œë¹„ìŠ¤
graphql/docker-compose.yml      â†’ GraphQL 3ê°œ ì„œë¹„ìŠ¤
monitoring/docker-compose.yml   â†’ ëª¨ë‹ˆí„°ë§
load-test/docker-compose.yml    â†’ ë¶€í•˜ í…ŒìŠ¤íŠ¸
docker-compose.full.yml         â†’ í†µí•© ì‹¤í–‰
```

## ğŸ³ Docker Compose ì¸í”„ë¼ êµ¬ì„± (ê²½ëŸ‰ ë²„ì „)

### ì „ì²´ ìŠ¤íƒ (docker-compose.lite.yml)

```yaml
ì´ 12ê°œ ì»¨í…Œì´ë„ˆ (~6GB RAM):

services:
  # ===== REST Architecture (4ê°œ) =====
  nginx:                    # REST Gateway (256MB)
  user-service-rest:        # ë…ë¦½ ì»¨í…Œì´ë„ˆ (512MB)
  robot-service-rest:       # ë…ë¦½ ì»¨í…Œì´ë„ˆ (512MB)
  site-service-rest:        # ë…ë¦½ ì»¨í…Œì´ë„ˆ (512MB)
  
  # ===== GraphQL Architecture (4ê°œ) =====
  apollo-router:            # GraphQL Router (1GB)
  user-subgraph:            # ë…ë¦½ ì»¨í…Œì´ë„ˆ (512MB)
  robot-subgraph:           # ë…ë¦½ ì»¨í…Œì´ë„ˆ (512MB)
  site-subgraph:            # ë…ë¦½ ì»¨í…Œì´ë„ˆ (512MB)
  
  # ===== Monitoring Stack (3ê°œ) =====
  prometheus:               # ë©”íŠ¸ë¦­ ìˆ˜ì§‘ (512MB)
  grafana:                  # ì‹œê°í™” ëŒ€ì‹œë³´ë“œ (512MB)
  cadvisor:                 # ì»¨í…Œì´ë„ˆ ëª¨ë‹ˆí„°ë§ (256MB)
  
  # ===== Load Testing (2ê°œ) =====
  locust-master:            # Locust Web UI (512MB)
  locust-worker:            # ë¶€í•˜ ìƒì„± 1ê°œ (512MB)
```

### ğŸ’» ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

| í•­ëª© | ê²½ëŸ‰ ë²„ì „ | í’€ë²„ì „ (ì°¸ê³ ) |
|------|----------|--------------|
| **RAM** | **8GB** | 16GB+ |
| **ì»¨í…Œì´ë„ˆ** | **12ê°œ** | 18ê°œ |
| **ìµœëŒ€ RPS** | **500** | 2000 |
| **íŒŒì¼** | **docker-compose.lite.yml** | docker-compose.yml |
| **í…ŒìŠ¤íŠ¸ ì‹œê°„** | **15ë¶„** | 60ë¶„ |

> âœ… **ì´ í”„ë¡œì íŠ¸ ê¸°ë³¸ êµ¬ì„±**: ê²½ëŸ‰ ë²„ì „ (8GB RAM)
> ğŸ“– í’€ë²„ì „ êµ¬ì„±: [docker-compose-êµ¬ì¡°.md](./docker-compose-êµ¬ì¡°.md)

### ğŸŒ ì ‘ì† í¬ì¸íŠ¸ (í…ŒìŠ¤íŠ¸ ê²°ê³¼ í™•ì¸)

| ì„œë¹„ìŠ¤ | URL | ìš©ë„ |
|--------|-----|------|
| **Locust UI** | http://localhost:8089 | ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ì‹¤ì‹œê°„ í†µê³„ |
| **Grafana** | http://localhost:3000 | ì„±ëŠ¥ ëŒ€ì‹œë³´ë“œ (admin/admin) |
| **Prometheus** | http://localhost:9090 | ë©”íŠ¸ë¦­ ì¿¼ë¦¬ ë° í™•ì¸ |
| **cAdvisor** | http://localhost:8081 | ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ |
| REST API | http://localhost:8080 | NGINX Gateway |
| GraphQL API | http://localhost:4000 | Apollo Router |

> ğŸ“ **ê²½ëŸ‰ ë²„ì „**: Tempo(ë¶„ì‚° ì¶”ì ) ì œì™¸ (ë©”ëª¨ë¦¬ ì ˆì•½)

### ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ í™•ì¸ ë°©ë²•

#### 1. Locust (http://localhost:8089)
```
ì‹¤ì‹œê°„ í™•ì¸ ê°€ëŠ¥:
âœ… Current RPS (ì´ˆë‹¹ ìš”ì²­ ìˆ˜)
âœ… Response Time (P50, P95, P99)
âœ… Failure Rate (ì—ëŸ¬ìœ¨)
âœ… Request Count (ì´ ìš”ì²­ ìˆ˜)
âœ… Charts (ì‹œê°„ë³„ ê·¸ë˜í”„)
```

#### 2. Grafana (http://localhost:3000)
```
ëŒ€ì‹œë³´ë“œ 2ê°œ ìë™ ìƒì„±:

ğŸ“Š Performance Overview
  - REST vs GraphQL RPS ë¹„êµ
  - Latency ë¶„í¬ (P50/P95/P99)
  - Success/Error Rate
  - Active Virtual Users

ğŸ“ˆ Resource Utilization
  - Gateway CPU (NGINX vs Apollo Router)
  - Gateway Memory Usage
  - Service CPU (ê° ì„œë¹„ìŠ¤ë³„)
  - Network I/O

ğŸ“ ê²½ëŸ‰ ë²„ì „: Distributed Tracing ëŒ€ì‹œë³´ë“œ ì œì™¸
```

#### 3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜ˆì‹œ
```bash
# 1. ê²½ëŸ‰ ì¸í”„ë¼ ì‹œì‘
docker-compose -f docker-compose.lite.yml up -d

# 2. ìƒíƒœ í™•ì¸
docker-compose -f docker-compose.lite.yml ps
docker stats  # ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸

# 3. Locust ì›¹ UI ì ‘ì†
open http://localhost:8089

# 4. í…ŒìŠ¤íŠ¸ ì„¤ì •
- Number of users: 100 (Phase 1)
- Spawn rate: 10 (ì´ˆë‹¹ 10ëª…ì”© ì¦ê°€)
- Host: locustfile.pyì—ì„œ ìë™ ì„ íƒ (REST/GraphQL ë³‘ë ¬ í…ŒìŠ¤íŠ¸)

# 5. Start swarming í´ë¦­

# 6. Grafanaì—ì„œ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
open http://localhost:3000
â†’ Dashboards â†’ Performance Overview

# 7. Phaseë³„ ì§„í–‰
- Phase 1: 100 users â†’ 3ë¶„ ì‹¤í–‰ â†’ Stop
- Phase 2: 300 users â†’ 5ë¶„ ì‹¤í–‰ â†’ Stop  
- Phase 3: 500 users â†’ 5ë¶„ ì‹¤í–‰ â†’ Stop

# 8. ê²°ê³¼ í™•ì¸
- Locust: RPS, Latency í†µê³„ ë‹¤ìš´ë¡œë“œ
- Grafana: ìŠ¤í¬ë¦°ìƒ· ì €ì¥
```

## âœ… í•µì‹¬ í¬ì¸íŠ¸

1. **ì™„ì „ ë¶„ë¦¬**: RESTì™€ GraphQL ë…ë¦½ ë””ë ‰í† ë¦¬, ì˜ì¡´ì„± ì—†ìŒ
2. **í”„ë¡œë•ì…˜ ì¤€ë¹„**: GraphQLì„ ì‹¤ì œ ë² ì´ìŠ¤ ì½”ë“œë¡œ ì‚¬ìš© ê°€ëŠ¥
3. **í´ë¦° ì•„í‚¤í…ì²˜**: GraphQL ì„œë¹„ìŠ¤ì— ë ˆì´ì–´ íŒ¨í„´ ì ìš©
4. **DB ì œì™¸**: ìˆœìˆ˜ API ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì„±ëŠ¥ë§Œ ì¸¡ì •
5. **In-memory ë°ì´í„°**: ê° ì„œë¹„ìŠ¤ê°€ ìì²´ ë°ì´í„° ë³´ìœ 
6. **ë…ë¦½ ì‹¤í–‰**: RESTë§Œ, GraphQLë§Œ, ë˜ëŠ” í†µí•© ì‹¤í–‰ ê°€ëŠ¥
7. **RPS ê¸°ë°˜**: ìœ ì € ìˆ˜ë¡œ RPS ì œì–´ (constant_throughput)
8. **ì‹¤ì‹œê°„ ì‹œê°í™”**: Locust UI + Grafana ëŒ€ì‹œë³´ë“œ
9. **4ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤**: ë‹¨ìˆœ â†’ ë³µì¡, N+1, ì§‘ê³„
10. **ì •ëŸ‰ì  ì˜ì‚¬ê²°ì •**: CPU, Memory, Latency, TPS ë°ì´í„° ê¸°ë°˜

## ğŸ¯ ì´ êµ¬ì¡°ì˜ ì¥ì 

### ì™„ì „í•œ ë…ë¦½ì„±
- RESTì™€ GraphQLì´ ì„œë¡œ ì˜í–¥ ì—†ìŒ
- GraphQL ë””ë ‰í† ë¦¬ë¥¼ ê·¸ëŒ€ë¡œ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ë¡œ ì´ë™ ê°€ëŠ¥

### í”„ë¡œë•ì…˜ í™œìš©
- GraphQL ì„œë¹„ìŠ¤ë¥¼ ì‹¤ì œ í”„ë¡œì íŠ¸ ë² ì´ìŠ¤ë¡œ ì‚¬ìš©
- í´ë¦° ì•„í‚¤í…ì²˜, Repository íŒ¨í„´ ì ìš©
- í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ êµ¬ì¡°

### ëª…í™•í•œ ë¹„êµ
- ë””ë ‰í† ë¦¬ë¡œ ì•„í‚¤í…ì²˜ êµ¬ë¶„
- ê°ì ìµœì ì˜ íŒ¨í„´ ì ìš©
- ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼ í•´ì„ ìš©ì´

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (V2 - ì™„ì „ ë¶„ë¦¬ êµ¬ì¡°)

### Phase 1: GraphQL ì„œë¹„ìŠ¤ êµ¬í˜„ (í”„ë¡œë•ì…˜ ìˆ˜ì¤€, 3-4ì‹œê°„)
- [ ] í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„± (graphql/)
- [ ] user-service êµ¬í˜„
  - [ ] schema/ (types, queries, mutations)
  - [ ] models/ (Pydantic)
  - [ ] data/ (repository)
  - [ ] core/ (config, logging)
  - [ ] tests/
- [ ] robot-service êµ¬í˜„ (DataLoader í¬í•¨)
- [ ] site-service êµ¬í˜„
- [ ] Apollo Router ì„¤ì •
- [ ] graphql/docker-compose.yml

### Phase 2: REST ì„œë¹„ìŠ¤ êµ¬í˜„ (ê°„ë‹¨í•˜ê²Œ, 2ì‹œê°„)
- [ ] í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ìƒì„± (rest/)
- [ ] user-service êµ¬í˜„ (ë‹¨ìˆœ êµ¬ì¡°)
- [ ] robot-service êµ¬í˜„ (cross-service í˜¸ì¶œ)
- [ ] site-service êµ¬í˜„
- [ ] NGINX ì„¤ì •
- [ ] rest/docker-compose.yml

### Phase 3: ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ (1ì‹œê°„)
- [ ] Prometheus ì„¤ì •
- [ ] Grafana ëŒ€ì‹œë³´ë“œ (2ê°œ)
- [ ] cAdvisor ì„¤ì •
- [ ] monitoring/docker-compose.monitoring.yml

### Phase 4: ë¶€í•˜ í…ŒìŠ¤íŠ¸ (1ì‹œê°„)
- [ ] locustfile_rest.py (4ê°€ì§€ API)
- [ ] locustfile_graphql.py (4ê°€ì§€ API)
- [ ] load-test/docker-compose.loadtest.yml

### Phase 5: í†µí•© ë° ìŠ¤í¬ë¦½íŠ¸ (1ì‹œê°„)
- [ ] docker-compose.full.yml (í†µí•©)
- [ ] scripts/start-rest.sh
- [ ] scripts/start-graphql.sh
- [ ] scripts/start-monitoring.sh
- [ ] scripts/run-test.sh

### Phase 6: í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (1ì‹œê°„)
- [ ] REST ë‹¨ë… í…ŒìŠ¤íŠ¸
- [ ] GraphQL ë‹¨ë… í…ŒìŠ¤íŠ¸
- [ ] REST vs GraphQL ë¹„êµ í…ŒìŠ¤íŠ¸
- [ ] ë°ì´í„° ìˆ˜ì§‘ ë° ë¶„ì„

**ì´ ì˜ˆìƒ ì‹œê°„: 9-12ì‹œê°„**

---

## ğŸ“‹ ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ

### RESTë§Œ ì‹¤í–‰
```bash
cd rest
docker-compose up -d

# í…ŒìŠ¤íŠ¸
open http://localhost:8080  # REST API
```

### GraphQLë§Œ ì‹¤í–‰
```bash
cd graphql
docker-compose up -d

# í…ŒìŠ¤íŠ¸
open http://localhost:4000  # GraphQL API
```

### ì „ì²´ ë¹„êµ í…ŒìŠ¤íŠ¸
```bash
# ë£¨íŠ¸ì—ì„œ
docker-compose -f docker-compose.full.yml up -d

# ëª¨ë‹ˆí„°ë§
open http://localhost:3000  # Grafana
open http://localhost:8089  # Locust
```

### GraphQL ê°œë°œ ëª¨ë“œ
```bash
cd graphql/services/robot-service
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn src.main:app --reload
```
