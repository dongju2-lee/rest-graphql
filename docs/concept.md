** User **
ì ìš°ë¦¬ê°€ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•´ì•¼í•´. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ ê°œë°œí• ê±°ê³  íŒŒì´ì¬ë°±ì—”ë“œì•¼. ê·¼ë° ê³ ë¯¼ì´ ìˆì–´ ë ˆìŠ¤íŠ¸ë¡œ í• ì§€ ê·¸ë˜í”„íì—˜ë¡œ ê°œë°œí• ì§€....ê·¸ë˜ì„œ ì„±ëŠ¥í…ŒìŠ¤íŠ¸ë¥¼ ë¹¡ì„ê²Œ í•˜ê³  ê°€ë³´ë ¤ê³ , ê·¼ë° ìš°ë¦¬ì‹œìŠ¤í…œì´ ì»¤ì„œ êµ¬í˜„í•˜ê¸° ì–´ë ¤ìš°ë‹ˆ ê°„ë‹¨í•˜ê²Œ ì•„í‚¤í…ì³ë§í•˜ì, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ëŠ” 3ê°œì •ë„í•˜ê³ , ë°ì´í„°ë² ì´ìŠ¤ëŠ” ë”± í•œê°œë¡œ ì“°ê³ , í´ë¼ì´ì–¸íŠ¸ì—ì„œ í˜¸ì¶œí•˜ëŠ” ì—ì´í”¼ì•„ì´ëŠ” ë”± 3ê°œ ë§Œë“¤ì, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—¬ì„œ ì§ì ‘ í•„ìš”í•˜ë©´ ì„œë¡œ í˜¸ì¶œí•´ì•¼í•˜ë‹ˆ í•„ìš”í•œ ì—ì´í”¼ì•„ì´ ë” ê°œë°œí•´ë„ ë˜ê³ , ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ì¶©ë¶„íˆ ì˜ í…ŒìŠ¤íŠ¸í• ìˆ˜ìˆìœ¼ë©´ ì¢‹ê² ëŠ”ë°, ì„¤ê³„ì¢€í•´ë´

** AI System **
ì¢‹ì•„, ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ë¡œ REST vs GraphQL ì„±ëŠ¥ ë¹„êµ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ê°„ë‹¨í•˜ë©´ì„œë„ ì˜ë¯¸ìˆëŠ” ì„¤ê³„ë¥¼ í•´ë³¼ê²Œ.
ì‹œë‚˜ë¦¬ì˜¤: ê°„ë‹¨í•œ ì´ì»¤ë¨¸ìŠ¤ ì‹œìŠ¤í…œ
ì‹¤ì œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ì„ ì˜ ë³´ì—¬ì¤„ ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¡œ ì¡ì•˜ì–´.
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Client                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           API Gateway                    â”‚
        â”‚   (REST ë²„ì „ / GraphQL ë²„ì „ ê°ê° êµ¬í˜„)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                   â–¼                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   User      â”‚    â”‚   Product   â”‚    â”‚   Order     â”‚
   â”‚   Service   â”‚    â”‚   Service   â”‚    â”‚   Service   â”‚
   â”‚   :8001     â”‚    â”‚   :8002     â”‚    â”‚   :8003     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PostgreSQL    â”‚
                    â”‚     :5432       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3ê°œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì„¤ê³„
1. User Service (:8001)
ë‚´ë¶€ APIì„¤ëª…GET /users/{id}ì‚¬ìš©ì ì •ë³´ ì¡°íšŒGET /users/{id}/profileí”„ë¡œí•„ ìƒì„¸ (Order Serviceê°€ í˜¸ì¶œ)
2. Product Service (:8002)
ë‚´ë¶€ APIì„¤ëª…GET /products/{id}ìƒí’ˆ ì •ë³´ ì¡°íšŒGET /products?ids=1,2,3ì—¬ëŸ¬ ìƒí’ˆ ì¼ê´„ ì¡°íšŒ (Order Serviceê°€ í˜¸ì¶œ)PATCH /products/{id}/stockì¬ê³  ì°¨ê° (Order Serviceê°€ í˜¸ì¶œ)
3. Order Service (:8003)
ë‚´ë¶€ APIì„¤ëª…POST /ordersì£¼ë¬¸ ìƒì„± (â†’ User, Product í˜¸ì¶œ)GET /orders/{id}ì£¼ë¬¸ ìƒì„¸ (â†’ User, Product í˜¸ì¶œ)GET /users/{id}/ordersì‚¬ìš©ì ì£¼ë¬¸ ëª©ë¡

í´ë¼ì´ì–¸íŠ¸ API 3ê°œ (ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ)
APIì„¤ëª…í…ŒìŠ¤íŠ¸ í¬ì¸íŠ¸1. ì£¼ë¬¸ ìƒì„¸ ì¡°íšŒì£¼ë¬¸ + ì‚¬ìš©ì + ìƒí’ˆë“¤ ì •ë³´N+1 ë¬¸ì œ, ë°ì´í„° ì§‘ê³„2. ì£¼ë¬¸ ìƒì„±ì¬ê³  í™•ì¸ â†’ ì°¨ê° â†’ ì£¼ë¬¸ ì €ì¥íŠ¸ëœì­ì…˜, ì„œë¹„ìŠ¤ê°„ í˜¸ì¶œ3. ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œì‚¬ìš©ì ì •ë³´ + ìµœê·¼ ì£¼ë¬¸ + ì£¼ë¬¸ë³„ ìƒí’ˆë³µì¡í•œ ì¤‘ì²© ë°ì´í„°

ì™œ ì´ ì„¤ê³„ê°€ í…ŒìŠ¤íŠ¸ì— ì¢‹ì€ì§€
í…ŒìŠ¤íŠ¸ ê´€ì ì´ ì„¤ê³„ì—ì„œ ê²€ì¦ ê°€ëŠ¥í•œ ê²ƒN+1 ë¬¸ì œì£¼ë¬¸ì— ìƒí’ˆ 5ê°œ ìˆìœ¼ë©´ RESTëŠ” 5ë²ˆ í˜¸ì¶œ, GraphQLì€ DataLoaderë¡œ 1ë²ˆOver-fetchingRESTëŠ” í•­ìƒ ì „ì²´ í•„ë“œ, GraphQLì€ í•„ìš”í•œ í•„ë“œë§Œì„œë¹„ìŠ¤ê°„ í†µì‹ Order â†’ User, Product í˜¸ì¶œ íŒ¨í„´ ë¹„êµë³µì¡í•œ ì¿¼ë¦¬ëŒ€ì‹œë³´ë“œ APIì—ì„œ ì¤‘ì²© ë°ì´í„° ì²˜ë¦¬ ì„±ëŠ¥

ë°ì´í„° ëª¨ë¸ (PostgreSQL)
sql-- users
id, email, name, created_at

-- products  
id, name, price, stock, category

-- orders
id, user_id, status, total_amount, created_at

-- order_items
id, order_id, product_id, quantity, price

ì´ ì„¤ê³„ë¡œ ê°€ë©´ ë ê¹Œ? ê´œì°®ìœ¼ë©´ ë°”ë¡œ êµ¬í˜„ ì‹œì‘í• ê²Œ.
REST ë²„ì „ì´ë‘ GraphQL ë²„ì „ ë‘˜ ë‹¤ ë§Œë“¤ì–´ì„œ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì„±ëŠ¥ ë¹„êµí•  ìˆ˜ ìˆê²Œ í•´ì¤„ê²Œ.ê·¸ ì£¼ë¬¸ìƒì œì¡°íšŒê°€ N+1ë§ì§€?ê·¼ë° ì €ë ‡ê²Œ ë˜ì–´ë„ í´ë¼ì´ì–¸íŠ¸ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê±´ìˆ˜ëŠ” ê°™ì§€? ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ ë‚´ë¶€ì—ì„œ í•„ìš”ì‹œ ë” ë‹¤ë¥¸ ì„œë¹„ìŠ¤ í˜¸ì¶œí•˜ëŠ”ê±°ê³ ?2ì›” 4ì¼ë§ì•„! ì •í™•í•˜ê²Œ ì´í•´í–ˆì–´.
í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œ vs ë‚´ë¶€ ì„œë¹„ìŠ¤ê°„ í˜¸ì¶œ
í´ë¼ì´ì–¸íŠ¸ â†’ API Gateway

í˜¸ì¶œ íšŸìˆ˜: 1ë²ˆ (RESTë“  GraphQLì´ë“  ë™ì¼)
GET /api/orders/123 (REST)
query { order(id: 123) { ... } } (GraphQL)

ë‚´ë¶€ì—ì„œ ì¼ì–´ë‚˜ëŠ” ì¼ (ì—¬ê¸°ì„œ ì°¨ì´ ë°œìƒ!)
REST ë°©ì‹:
Client â†’ API Gateway (1ë²ˆ)
         â†“
    Order Service
         â†“
    1. GET /orders/123 ì¡°íšŒ
       â†’ order_itemsì— ìƒí’ˆì´ 5ê°œ ìˆìŒ
    2. GET /users/456 (User Service í˜¸ì¶œ 1ë²ˆ)
    3. GET /products/1 (Product Service í˜¸ì¶œ)
    4. GET /products/2 (Product Service í˜¸ì¶œ)
    5. GET /products/3 (Product Service í˜¸ì¶œ)
    6. GET /products/4 (Product Service í˜¸ì¶œ)
    7. GET /products/5 (Product Service í˜¸ì¶œ)
    â†“
    ì´ ë‚´ë¶€ í˜¸ì¶œ: 6ë²ˆ (User 1ë²ˆ + Product 5ë²ˆ)
GraphQL ë°©ì‹ (DataLoader ì‚¬ìš©ì‹œ):
Client â†’ API Gateway (1ë²ˆ)
         â†“
    Order Service
         â†“
    1. GET /orders/123 ì¡°íšŒ
       â†’ order_itemsì— ìƒí’ˆì´ 5ê°œ ìˆìŒ
    2. GET /users/456 (User Service í˜¸ì¶œ 1ë²ˆ)
    3. GET /products?ids=1,2,3,4,5 (Product Service í˜¸ì¶œ 1ë²ˆ)
    â†“
    ì´ ë‚´ë¶€ í˜¸ì¶œ: 2ë²ˆ (User 1ë²ˆ + Product 1ë²ˆ - ë°°ì¹˜)

ì„±ëŠ¥ ì°¨ì´ í¬ì¸íŠ¸
í•­ëª©RESTGraphQL (DataLoader)í´ë¼ì´ì–¸íŠ¸ ìš”ì²­1ë²ˆ1ë²ˆë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œN+1ë²ˆ2ë²ˆë„¤íŠ¸ì›Œí¬ ë ˆì´í„´ì‹œë†’ìŒ (í˜¸ì¶œ ë§ìŒ)ë‚®ìŒ (ë°°ì¹˜ ì²˜ë¦¬)ì„œë¹„ìŠ¤ ë¶€í•˜ë¶„ì‚°ë¨ (ì—¬ëŸ¬ë²ˆ)ì§‘ì¤‘ë¨ (ì ê²Œ)

ì¶”ê°€ë¡œ í…ŒìŠ¤íŠ¸í•  í¬ì¸íŠ¸
ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ API ê°™ì€ ê²½ìš°ëŠ” ë” ê·¹ì ì´ì•¼:
ìµœê·¼ ì£¼ë¬¸ 10ê°œ + ê° ì£¼ë¬¸ì˜ ìƒí’ˆë“¤ (í‰ê·  3ê°œì”©)

REST: 1(ì‚¬ìš©ì) + 10(ì£¼ë¬¸ë“¤) + 30(ìƒí’ˆë“¤) = 41ë²ˆ ë‚´ë¶€ í˜¸ì¶œ
GraphQL: 1(ì‚¬ìš©ì) + 1(ì£¼ë¬¸ ë°°ì¹˜) + 1(ìƒí’ˆ ë°°ì¹˜) = 3ë²ˆ ë‚´ë¶€ í˜¸ì¶œ
ì´ê²Œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œ REST vs GraphQLì˜ ì§„ì§œ ì°¨ì´ì ì´ì•¼.
í´ë¼ì´ì–¸íŠ¸ëŠ” 1ë²ˆë§Œ í˜¸ì¶œí•˜ì§€ë§Œ, ë’¤ì—ì„œ ì„œë¹„ìŠ¤ë“¤ì´ ì„œë¡œ ì–¼ë§ˆë‚˜ íš¨ìœ¨ì ìœ¼ë¡œ í†µì‹ í•˜ëŠëƒê°€ í•µì‹¬!
ì´ êµ¬ì¡°ë¡œ ì§„í–‰í• ê¹Œ?

** User **

ìš°ë¦¬ëŠ” b2bë¼ì„œ ì»¤ë¨¸ìŠ¤ë§Œí¼ ë³µì¡ë„ê°€ ë†’ì§€ëŠ” ì•Šì„ê±°ê°™ì€ë°....ë„ˆë¬´ ê·¹ë‹¨ì ì¸ê±° ì•„ë‹ˆì•¼?

** AI System **
 ë§ì•„, B2Bë©´ ì»¤ë¨¸ìŠ¤ë³´ë‹¤ëŠ” í›¨ì”¬ ë‹¨ìˆœí•˜ì§€.
ì¢€ ë” í˜„ì‹¤ì ì¸ B2B ì‹œë‚˜ë¦¬ì˜¤ë¡œ ë°”ê¿”ë³¼ê²Œ.

ì‹œë‚˜ë¦¬ì˜¤: B2B SaaS ëŒ€ì‹œë³´ë“œ ì‹œìŠ¤í…œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Client (ê¸°ì—… ê´€ë¦¬ì)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           API Gateway                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                   â”‚
          â–¼                   â–¼                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Company    â”‚    â”‚   User      â”‚    â”‚  Usage      â”‚
   â”‚  Service    â”‚    â”‚   Service   â”‚    â”‚  Service    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PostgreSQL    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3ê°œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤
1. Company Service

ê¸°ì—… ì •ë³´, êµ¬ë… í”Œëœ, ì„¤ì • ê´€ë¦¬
GET /companies/{id}
GET /companies/{id}/settings

2. User Service

ê¸°ì—… ì†Œì† ì‚¬ìš©ì ê´€ë¦¬
GET /users/{id}
GET /companies/{company_id}/users (Company Serviceê°€ í˜¸ì¶œ)

3. Usage Service

ì‚¬ìš©ëŸ‰, ë¡œê·¸, ì´ë²¤íŠ¸ ì¶”ì 
GET /users/{user_id}/usage (User Serviceê°€ í˜¸ì¶œ)
GET /companies/{company_id}/usage-summary (Company Serviceê°€ í˜¸ì¶œ)


í´ë¼ì´ì–¸íŠ¸ API 3ê°œ
1. ê¸°ì—… ëŒ€ì‹œë³´ë“œ ì¡°íšŒ
GET /api/companies/{id}/dashboard
í¬í•¨ ë°ì´í„°:

ê¸°ì—… ì •ë³´ (í”Œëœ, ì„¤ì •)
ì†Œì† ì‚¬ìš©ì ëª©ë¡ (10ëª… ì •ë„)
ì „ì²´ ì‚¬ìš©ëŸ‰ ìš”ì•½

ë‚´ë¶€ í˜¸ì¶œ:

REST: Company(1) + Users(1) + Usage(10) = 12ë²ˆ
GraphQL: Company(1) + Users(1) + Usage(1 ë°°ì¹˜) = 3ë²ˆ


2. ì‚¬ìš©ì ìƒì„¸ + í™œë™ ë‚´ì—­
GET /api/users/{id}/details
í¬í•¨ ë°ì´í„°:

ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´
ì†Œì† ê¸°ì—… ì •ë³´
ìµœê·¼ 30ì¼ ì‚¬ìš© í†µê³„

ë‚´ë¶€ í˜¸ì¶œ:

REST: User(1) + Company(1) + Usage(1) = 3ë²ˆ
GraphQL: ë™ì¼ 3ë²ˆ

â†’ ì´ê±´ ì°¨ì´ ì—†ìŒ (N+1 ì•„ë‹˜)

3. íŒ€ë³„ ì‚¬ìš©ëŸ‰ ë¦¬í¬íŠ¸
GET /api/companies/{id}/team-report
í¬í•¨ ë°ì´í„°:

ê¸°ì—… ì •ë³´
ì‚¬ìš©ìë³„ ì‚¬ìš©ëŸ‰ (20ëª…)

ë‚´ë¶€ í˜¸ì¶œ:

REST: Company(1) + Users(1) + Usage(20) = 22ë²ˆ
GraphQL: Company(1) + Users(1) + Usage(1 ë°°ì¹˜) = 3ë²ˆ


ì™œ ì´ê²Œ ë” í˜„ì‹¤ì ì¸ê°€?
ì»¤ë¨¸ìŠ¤ ì‹œë‚˜ë¦¬ì˜¤B2B SaaS ì‹œë‚˜ë¦¬ì˜¤ì£¼ë¬¸ë‹¹ ìƒí’ˆ ìˆ˜ì‹­ê°œê¸°ì—…ë‹¹ ì‚¬ìš©ì 10~20ëª…ì¬ê³  íŠ¸ëœì­ì…˜ ë³µì¡ë‹¨ìˆœ ì¡°íšŒ ìœ„ì£¼ì‹¤ì‹œê°„ ì¬ê³  ì°¨ê°ë°°ì¹˜ ì§‘ê³„ ê°€ëŠ¥
B2BëŠ” ì¡°íšŒê°€ 80%, ì“°ê¸°ê°€ 20% ì •ë„ë¼ì„œ:

N+1ì€ ì—¬ì „íˆ ë°œìƒí•˜ì§€ë§Œ "10~20ë°°" ì •ë„ ì°¨ì´
íŠ¸ëœì­ì…˜ ë³µì¡ë„ëŠ” ë‚®ìŒ
ìºì‹± íš¨ê³¼ê°€ ë” ì¢‹ìŒ


ì´ ì •ë„ë©´ ì ë‹¹í•´? ì•„ë‹ˆë©´ ë” ë‹¨ìˆœí•˜ê²Œ ê°ˆê¹Œ?

** User **
ë¡œë´‡ê´€ë ¨ ëª¨ë‹ˆí„°ë§ì„œë¹„ìŠ¤ì•¼, ìš°ë¦¬ ë‚´ë¶€ê°œë°œìë“¤ì´ ë³´ëŠ”ê±°ê³ , ë‹¤ì‹œ ì­‰ ì„¤ê³„í•´ë³´ì

** AI System **
ì•„ ë¡œë´‡ ëª¨ë‹ˆí„°ë§ì´ë©´ ì™„ì „ ë‹¤ë¥´ë„¤! ë‚´ë¶€ ê°œë°œììš©ì´ë©´ ë” í˜„ì‹¤ì ìœ¼ë¡œ ê°€ì.

ì‹œë‚˜ë¦¬ì˜¤: ë¡œë´‡ í”Œë¦¿ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Client (ë‚´ë¶€ ê°œë°œì/ìš´ì˜ì)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           API Gateway                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                   â”‚
          â–¼                   â–¼                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Robot     â”‚    â”‚   Telemetry â”‚    â”‚   Alert     â”‚
   â”‚   Service   â”‚    â”‚   Service   â”‚    â”‚   Service   â”‚
   â”‚   :8001     â”‚    â”‚   :8002     â”‚    â”‚   :8003     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PostgreSQL    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3ê°œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì„¤ê³„
1. Robot Service (:8001)
ë¡œë´‡ ë©”íƒ€ë°ì´í„° ë° ìƒíƒœ ê´€ë¦¬
APIì„¤ëª…GET /robots/{id}ë¡œë´‡ ê¸°ë³¸ ì •ë³´ (ëª¨ë¸, ìœ„ì¹˜, íŒì›¨ì–´ ë²„ì „)GET /robotsì „ì²´ ë¡œë´‡ ëª©ë¡GET /robots/{id}/configë¡œë´‡ ì„¤ì • ì •ë³´ (Alert Serviceê°€ í˜¸ì¶œ)
ë°ì´í„°:
python{
  "id": "robot-001",
  "name": "Warehouse-Robot-A",
  "model": "AGV-X200",
  "location": "Building-3-Floor-2",
  "firmware_version": "v2.3.1",
  "status": "active"
}

2. Telemetry Service (:8002)
ì„¼ì„œ ë°ì´í„° ë° ì„±ëŠ¥ ë©”íŠ¸ë¦­
APIì„¤ëª…GET /telemetry/robots/{id}/latestìµœì‹  í…”ë ˆë©”íŠ¸ë¦¬ (ë°°í„°ë¦¬, CPU, ì˜¨ë„)GET /telemetry/robots/{id}/metrics?period=1hì‹œê³„ì—´ ë©”íŠ¸ë¦­POST /telemetry/batch-queryì—¬ëŸ¬ ë¡œë´‡ ì¼ê´„ ì¡°íšŒ (Alert Serviceê°€ í˜¸ì¶œ)
ë°ì´í„°:
python{
  "robot_id": "robot-001",
  "timestamp": "2024-02-04T10:30:00Z",
  "battery_level": 85.5,
  "cpu_usage": 45.2,
  "temperature": 42.1,
  "network_latency_ms": 12
}

3. Alert Service (:8003)
ì•ŒëŒ ë° ì´ë²¤íŠ¸ ê´€ë¦¬
APIì„¤ëª…GET /alerts/robots/{id}íŠ¹ì • ë¡œë´‡ì˜ í™œì„± ì•ŒëŒGET /alerts?severity=criticalì‹¬ê°ë„ë³„ ì•ŒëŒ í•„í„°ë§GET /alerts/{id}/detailsì•ŒëŒ ìƒì„¸ (â†’ Robot, Telemetry í˜¸ì¶œ)
ë°ì´í„°:
python{
  "id": "alert-123",
  "robot_id": "robot-001",
  "type": "battery_low",
  "severity": "warning",
  "message": "Battery below 20%",
  "timestamp": "2024-02-04T10:25:00Z"
}
```

---

## í´ë¼ì´ì–¸íŠ¸ API 3ê°œ (ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ)

### 1. **í”Œë¦¿ ëŒ€ì‹œë³´ë“œ (Fleet Overview)**
```
GET /api/fleet/dashboard
```

**ì‘ë‹µ ë°ì´í„°:**
- ì „ì²´ ë¡œë´‡ ëª©ë¡ (15ëŒ€)
- ê° ë¡œë´‡ì˜ ìµœì‹  í…”ë ˆë©”íŠ¸ë¦¬
- í™œì„± ì•ŒëŒ ì¹´ìš´íŠ¸

**ë‚´ë¶€ í˜¸ì¶œ:**
```
REST:
- GET /robots (1ë²ˆ)
- GET /telemetry/robots/{id}/latest Ã— 15ë²ˆ
- GET /alerts/robots/{id} Ã— 15ë²ˆ
= ì´ 31ë²ˆ

GraphQL (DataLoader):
- GET /robots (1ë²ˆ)  
- POST /telemetry/batch-query (1ë²ˆ - 15ëŒ€ ì¼ê´„)
- GET /alerts?robot_ids=... (1ë²ˆ - 15ëŒ€ ì¼ê´„)
= ì´ 3ë²ˆ
```

**N+1 ë°œìƒ: ë¡œë´‡ ìˆ˜ë§Œí¼ ë°˜ë³µ ì¡°íšŒ**

---

### 2. **ë¡œë´‡ ìƒì„¸ ëª¨ë‹ˆí„°ë§**
```
GET /api/robots/{id}/monitor
```

**ì‘ë‹µ ë°ì´í„°:**
- ë¡œë´‡ ê¸°ë³¸ ì •ë³´
- ìµœê·¼ 1ì‹œê°„ ë©”íŠ¸ë¦­ (ì‹œê³„ì—´)
- ìµœê·¼ ì•ŒëŒ 5ê°œ

**ë‚´ë¶€ í˜¸ì¶œ:**
```
REST & GraphQL ë™ì¼:
- GET /robots/{id} (1ë²ˆ)
- GET /telemetry/robots/{id}/metrics?period=1h (1ë²ˆ)
- GET /alerts/robots/{id}?limit=5 (1ë²ˆ)
= ì´ 3ë²ˆ
```

**ì°¨ì´ ì—†ìŒ: 1:1 ê´€ê³„ë¼ì„œ N+1 ì•„ë‹˜**

---

### 3. **ì•ŒëŒ ìƒì„¸ ì¡°íšŒ (ì—¬ëŸ¬ ê±´)**
```
GET /api/alerts/critical
```

**ì‘ë‹µ ë°ì´í„°:**
- ì‹¬ê°ë„ critical ì•ŒëŒ 10ê°œ
- ê° ì•ŒëŒì˜ ë¡œë´‡ ì •ë³´
- ê° ì•ŒëŒ ë°œìƒ ì‹œì ì˜ í…”ë ˆë©”íŠ¸ë¦¬ ìŠ¤ëƒ…ìƒ·

**ë‚´ë¶€ í˜¸ì¶œ:**
```
REST:
- GET /alerts?severity=critical (1ë²ˆ)
- GET /robots/{id} Ã— 10ë²ˆ
- GET /telemetry/robots/{id}/latest Ã— 10ë²ˆ  
= ì´ 21ë²ˆ

GraphQL (DataLoader):
- GET /alerts?severity=critical (1ë²ˆ)
- GET /robots?ids=... (1ë²ˆ - ë°°ì¹˜)
- POST /telemetry/batch-query (1ë²ˆ - ë°°ì¹˜)
= ì´ 3ë²ˆ
N+1 ë°œìƒ: ì•ŒëŒ ê°œìˆ˜ë§Œí¼ ë°˜ë³µ ì¡°íšŒ

ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
sql-- robots
id, name, model, location, firmware_version, status, created_at

-- telemetry_data
id, robot_id, timestamp, battery_level, cpu_usage, temperature, network_latency_ms

-- alerts  
id, robot_id, type, severity, message, status, created_at, resolved_at

ì™œ ì´ ì„¤ê³„ê°€ í˜„ì‹¤ì ì¸ê°€?
íŠ¹ì§•ë¡œë´‡ ëª¨ë‹ˆí„°ë§ íŠ¹ì„±ì¡°íšŒ íŒ¨í„´ëŒ€ì‹œë³´ë“œì—ì„œ ì—¬ëŸ¬ ë¡œë´‡ í•œë²ˆì— ì¡°íšŒ (N+1 ìì£¼ ë°œìƒ)ë°ì´í„° ë¹ˆë„í…”ë ˆë©”íŠ¸ë¦¬ëŠ” ì´ˆë‹¹ ìˆ˜ì‹­~ìˆ˜ë°±ê±´ (ì‹œê³„ì—´ DB ê³ ë ¤)ë³µì¡ë„íŠ¸ëœì­ì…˜ ë‹¨ìˆœ, ì¡°íšŒ ìœ„ì£¼ì‚¬ìš©ìë‚´ë¶€ ê°œë°œì â†’ ë³µì¡í•œ ì¿¼ë¦¬ ê°€ëŠ¥

ì¶”ê°€ ê³ ë ¤ì‚¬í•­
í…”ë ˆë©”íŠ¸ë¦¬ ë°ì´í„°ê°€ ë§ìœ¼ë©´:

PostgreSQL ë§ê³  TimescaleDBë‚˜ InfluxDB ê³ ë ¤
í•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ ëª©ì ì´ë‹ˆ PostgreSQL + ì¸ë±ì‹±ìœ¼ë¡œ ì¶©ë¶„

ì‹¤ì‹œê°„ì„±:

WebSocket/SSEëŠ” ì¼ë‹¨ ì œì™¸
REST/GraphQL í´ë§ìœ¼ë¡œë§Œ ë¹„êµ

ì´ ì •ë„ë©´ ì ë‹¹í•´? ë¡œë´‡ 15ëŒ€ ì •ë„ë¡œ í…ŒìŠ¤íŠ¸í•˜ë©´ N+1 ì°¨ì´ í™•ì‹¤íˆ ë³´ì¼ ê±°ì•¼!ê·¸ë˜ ë”±ì¢‹ë‹¤. ë‹¤ì‹œë§í•˜ì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ ì½œìˆ˜ëŠ” ë˜‘ê°™ì§€? ë‚´ë¶€ì ìœ¼ë¡œ ì„œë¡œ í˜¸ì¶œëŸ‰ì€ ë‹¬ë¼ë„? ê·¸ë¦¬ê³  ì•„í´ë¡œë‘ ìŠ¤íŠ¸ë¡œë² ë¦¬ëŠ” ì¨ì•¼í•´2ì›” 4ì¼ë§ì•„! ì •í™•í•´.

í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œ íšŸìˆ˜: REST = GraphQL
í´ë¼ì´ì–¸íŠ¸ â†’ API Gateway: í•­ìƒ 1ë²ˆ

GET /api/fleet/dashboard (REST)
query { fleetDashboard { ... } } (GraphQL)
ë‚´ë¶€ì—ì„œë§Œ ì°¨ì´ ë°œìƒ:

REST: 31ë²ˆ (Robot 1 + Telemetry 15 + Alert 15)
GraphQL: 3ë²ˆ (DataLoaderë¡œ ë°°ì¹˜ ì²˜ë¦¬)


ê¸°ìˆ  ìŠ¤íƒ í™•ì •
GraphQL

Apollo Server (Node.js/Express) ë˜ëŠ”
Strawberry (Python/FastAPI)

ë‘˜ ë‹¤ ì¨ì•¼ í•œë‹¤ëŠ” ê±´ ë¹„êµ í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ê±°ì•¼? ì•„ë‹ˆë©´ í•˜ë‚˜ë§Œ ì„ íƒ?
ì¶”ì²œ ì¡°í•©
Option 1: Python í’€ìŠ¤íƒ (ì¶”ì²œ)
API Gateway (GraphQL): Strawberry + FastAPI
ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ 3ê°œ: FastAPI (REST)

ì¥ì : ì–¸ì–´ í†µì¼, ê´€ë¦¬ í¸í•¨
Strawberryê°€ DataLoader ì§€ì›í•¨

Option 2: Apollo + Python
API Gateway (GraphQL): Apollo Server (Node.js)
ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ 3ê°œ: FastAPI (REST)

ì¥ì : Apollo ìƒíƒœê³„ ê°•ë ¥ (Apollo Studio, ìºì‹±)
ë‹¨ì : Node.js + Python í˜¼ìš©

Option 3: ë‘˜ ë‹¤ êµ¬í˜„ (ë¹„êµìš©)
GraphQL ë²„ì „ A: Strawberry
GraphQL ë²„ì „ B: Apollo Server
ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤: FastAPI (ê³µí†µ)

Apollo vs Strawberry ì„±ëŠ¥ë„ ë¹„êµ ê°€ëŠ¥


ë‚´ê°€ ì¶”ì²œí•˜ëŠ” ë°©ì‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚
         â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ REST Gateway â”‚  â”‚ GraphQL GW   â”‚
â”‚  (FastAPI)   â”‚  â”‚ (Strawberry) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Microservices (3ê°œ)  â”‚
    â”‚  FastAPI (REST)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ë™ì¼í•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ ë‘ Gatewayê°€ í˜¸ì¶œ
â†’ REST vs GraphQL ì •í™•í•œ ë¹„êµ ê°€ëŠ¥

ì–´ë–»ê²Œ í• ê¹Œ?

Strawberryë§Œ (Python í’€ìŠ¤íƒ)
Apolloë§Œ (Node + Python)
ë‘˜ ë‹¤ (ë¹„êµ í…ŒìŠ¤íŠ¸)

ì¶”ì²œì€ **1ë²ˆ (Strawberry)**ì¸ë°, Apolloë„ ë³´ê³  ì‹¶ìœ¼ë©´ 3ë²ˆ!

** User **
ê·¼ë° ì•„í´ë¡œë‘ ìŠ¤íŠ¸ë¡œë² ë¦¬ëŠ” ë¬´ìŠ¨ ì°¨ì´ì•¼? ì •í™•íˆ ë§í•´ì¤˜

** AI System **
ì¢‹ì•„, ì •í™•í•˜ê²Œ ë¹„êµí•´ì¤„ê²Œ.

Apollo Server vs Strawberry: í•µì‹¬ ì°¨ì´
1. ì–¸ì–´ ë° ìƒíƒœê³„
Apollo ServerStrawberryì–¸ì–´JavaScript/TypeScript (Node.js)Pythoní”„ë ˆì„ì›Œí¬Express, Fastify, Koa ë“±FastAPI, Django, Flask ë“±íƒ€ì… ì‹œìŠ¤í…œTypeScript ê¸°ë°˜Python Type Hints ê¸°ë°˜

2. ìŠ¤í‚¤ë§ˆ ì •ì˜ ë°©ì‹
Apollo Server (Schema First)
typescript// SDLë¡œ ìŠ¤í‚¤ë§ˆ ë¨¼ì € ì •ì˜
const typeDefs = gql`
  type Robot {
    id: ID!
    name: String!
    batteryLevel: Float
  }
  
  type Query {
    robot(id: ID!): Robot
  }
`;

// ë¦¬ì¡¸ë²„ ë³„ë„ êµ¬í˜„
const resolvers = {
  Query: {
    robot: (parent, args, context) => {
      return fetchRobot(args.id);
    }
  }
};
Strawberry (Code First)
python# íŒŒì´ì¬ ì½”ë“œë¡œ ìŠ¤í‚¤ë§ˆ ìƒì„±
import strawberry

@strawberry.type
class Robot:
    id: str
    name: str
    battery_level: float | None

@strawberry.type
class Query:
    @strawberry.field
    def robot(self, id: str) -> Robot:
        return fetch_robot(id)

3. DataLoader êµ¬í˜„
Apollo Server
typescriptimport DataLoader from 'dataloader';

const robotLoader = new DataLoader(async (ids) => {
  const robots = await fetchRobotsByIds(ids);
  return ids.map(id => robots.find(r => r.id === id));
});

// ë¦¬ì¡¸ë²„ì—ì„œ ì‚¬ìš©
const resolvers = {
  Alert: {
    robot: (alert, args, { robotLoader }) => {
      return robotLoader.load(alert.robotId);
    }
  }
};
Strawberry
pythonfrom strawberry.dataloader import DataLoader

async def load_robots(keys: list[str]) -> list[Robot]:
    robots = await fetch_robots_by_ids(keys)
    return [robots.get(k) for k in keys]

robot_loader = DataLoader(load_fn=load_robots)

@strawberry.type
class Alert:
    robot_id: str
    
    @strawberry.field
    async def robot(self) -> Robot:
        return await robot_loader.load(self.robot_id)
ì°¨ì´ì :

Apollo: ë³„ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬ (dataloader íŒ¨í‚¤ì§€)
Strawberry: ë‚´ì¥ ì§€ì› (strawberry.dataloader)


4. ì£¼ìš” ê¸°ëŠ¥ ë¹„êµ
ê¸°ëŠ¥Apollo ServerStrawberryDataLoaderâœ… (ë³„ë„ ì„¤ì¹˜)âœ… (ë‚´ì¥)Subscriptionâœ… (WebSocket)âœ… (WebSocket, SSE)Federationâœ… (Apollo Federation)âœ… (ì‹¤í—˜ì )Cachingâœ… (Apollo Cache Control)âš ï¸ (ìˆ˜ë™ êµ¬í˜„)Tracingâœ… (Apollo Studio)âš ï¸ (OpenTelemetry ì—°ë™)Playgroundâœ… (Apollo Sandbox)âœ… (GraphiQL)Type Safetyâœ… (TypeScript)âœ… (Python Type Hints)

5. ì„±ëŠ¥ íŠ¹ì„±
Apollo Server (Node.js)

ë¹„ë™ê¸° I/O ìµœì í™” (ì´ë²¤íŠ¸ ë£¨í”„)
ë‹¨ì¼ ìŠ¤ë ˆë“œì§€ë§Œ I/O bound ì‘ì—…ì— ê°•í•¨
CPU intensive ì‘ì—…ì€ ì•½í•¨

Strawberry (Python)

asyncio ê¸°ë°˜ (FastAPIì™€ ì°°ë–¡)
CPU boundëŠ” ë©€í‹°í”„ë¡œì„¸ì‹± í•„ìš”
I/O boundëŠ” Apolloì™€ ë¹„ìŠ·í•œ ì„±ëŠ¥


6. ê°œë°œì ê²½í—˜ (DX)
Apollo Server
typescriptâœ… TypeScriptë¡œ íƒ€ì… ì•ˆì „ì„± 100%
âœ… Apollo Studio (ë¬´ë£Œ) - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§, ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬
âœ… ë°©ëŒ€í•œ ìƒíƒœê³„ (Apollo Client, Apollo Router)
âš ï¸ JS/TS ëŸ¬ë‹ì»¤ë¸Œ (Python ê°œë°œìì—ê²Œ)
Strawberry
pythonâœ… Python ë„¤ì´í‹°ë¸Œ - ê¸°ì¡´ FastAPI ì½”ë“œ ì¬ì‚¬ìš©
âœ… ì§ê´€ì ì¸ ë°ì½”ë ˆì´í„° ë¬¸ë²•
âœ… Pydantic ëª¨ë¸ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥
âš ï¸ Apollo Studio ê°™ì€ ê´€ë¦¬ ë„êµ¬ ì—†ìŒ
âš ï¸ Federation ì§€ì› ì•½í•¨

7. í”„ë¡œë•ì…˜ ë„êµ¬
ë„êµ¬ApolloStrawberryëª¨ë‹ˆí„°ë§Apollo Studio (ë¬´ë£Œ)Prometheus + GrafanaìŠ¤í‚¤ë§ˆ ê´€ë¦¬Schema Registryìˆ˜ë™ ê´€ë¦¬ìºì‹±Automatic Persisted QueriesRedis ì§ì ‘ ì—°ë™Rate LimitingApollo RouterFastAPI middleware

ì‹¤ì „ ë¹„êµ: ê°™ì€ ê¸°ëŠ¥ êµ¬í˜„
í”Œë¦¿ ëŒ€ì‹œë³´ë“œ ì¿¼ë¦¬
Apollo Server
typescripttype Query {
  fleetDashboard: FleetDashboard!
}

type FleetDashboard {
  robots: [Robot!]!
}

type Robot {
  id: ID!
  name: String!
  latestTelemetry: Telemetry
  activeAlerts: [Alert!]!
}

const resolvers = {
  Robot: {
    latestTelemetry: (robot, _, { telemetryLoader }) => {
      return telemetryLoader.load(robot.id);
    },
    activeAlerts: (robot, _, { alertLoader }) => {
      return alertLoader.load(robot.id);
    }
  }
};
Strawberry
python@strawberry.type
class Query:
    @strawberry.field
    async def fleet_dashboard(self) -> FleetDashboard:
        return await get_fleet_dashboard()

@strawberry.type
class Robot:
    id: str
    name: str
    
    @strawberry.field
    async def latest_telemetry(self) -> Telemetry:
        return await telemetry_loader.load(self.id)
    
    @strawberry.field  
    async def active_alerts(self) -> list[Alert]:
        return await alert_loader.load(self.id)

ë„ˆì˜ ìƒí™©ì—ì„œ ì¶”ì²œ
Strawberryë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ” ê²½ìš°:
âœ… ë°±ì—”ë“œê°€ ì´ë¯¸ Python (FastAPI)
âœ… íŒ€ì´ Pythonì— ìµìˆ™í•¨
âœ… ê°„ë‹¨í•œ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ (Apollo Studio ë¶ˆí•„ìš”)
âœ… ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘ í•„ìš”
Apolloë¥¼ ì„ íƒí•´ì•¼ í•˜ëŠ” ê²½ìš°:
âœ… ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ê´€ë¦¬ ë„êµ¬ í•„ìš”
âœ… Microservice Federation í•„ìš”
âœ… Apollo Client ì‚¬ìš© (í”„ë¡ íŠ¸ì—”ë“œ)
âœ… íŒ€ì— Node.js ê°œë°œì ìˆìŒ

ìµœì¢… ì¶”ì²œ
ë„ˆì˜ ê²½ìš° (ë¡œë´‡ ëª¨ë‹ˆí„°ë§, Python ë°±ì—”ë“œ):
â†’ Strawberry ì¶”ì²œ ğŸ“
ì´ìœ :

ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ FastAPIë©´ ì–¸ì–´ í†µì¼
DataLoader ë‚´ì¥ì´ë¼ N+1 í•´ê²° ì‰¬ì›€
Type Hintsë¡œ íƒ€ì… ì•ˆì „ì„± í™•ë³´
ë‚´ë¶€ ë„êµ¬ë¼ Apollo Studio ë¶ˆí•„ìš”
ëŸ¬ë‹ì»¤ë¸Œ ë‚®ìŒ

í•˜ì§€ë§Œ Apolloë„ í…ŒìŠ¤íŠ¸í•´ë³¼ ê°€ì¹˜ ìˆìŒ:

ì„±ëŠ¥ ë¹„êµ ëª©ì ì´ë©´ ë‘˜ ë‹¤ êµ¬í˜„
Apollo Federation ë‚˜ì¤‘ì— í•„ìš”í•  ìˆ˜ë„

ì–´ë–»ê²Œ í• ê¹Œ? Strawberryë¡œ ê°€ê³ , ë‚˜ì¤‘ì— í•„ìš”í•˜ë©´ Apollo ì¶”ê°€?

** User **
ì•„í´ë¡œ https://github.com/apollographql/apollo-server ì´ê±° ...ì´ê±° ê·¸ëƒ¥ ì—”ì§„ì—‘ìŠ¤ê°™ì€ê±° ì•„ë‹ˆì•¼? ê·¸ë˜í”„ë·°ì—˜ í˜ë”ë ˆì´ì…˜í•´ì£¼ê³ ?

** AI System **
ì•„ ì ê¹, ë„¤ê°€ ë§ëŠ” ë¶€ë¶„ë„ ìˆê³  ì•„ë‹Œ ë¶€ë¶„ë„ ìˆì–´. ì •ë¦¬í•´ì¤„ê²Œ.

Apollo Serverì˜ ì •ì²´
Apollo ServerëŠ” GraphQL ì—”ì§„ì´ì•¼. ë„¤ê°€ ìƒê°í•œ ê²ƒì²˜ëŸ¼:
âŒ Nginx ê°™ì€ ìˆœìˆ˜ í”„ë¡ì‹œëŠ” ì•„ë‹˜

ìš”ì²­ë§Œ ë¼ìš°íŒ…í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼
GraphQL ì¿¼ë¦¬ë¥¼ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ëŠ” ì„œë²„

âœ… í•˜ì§€ë§Œ Federationì—ì„œëŠ” "ê²Œì´íŠ¸ì›¨ì´" ì—­í• ë„ í•¨

Apolloì˜ ë‘ ê°€ì§€ ì—­í• 
1. ë‹¨ì¼ GraphQL ì„œë²„ (ìš°ë¦¬ê°€ ì“¸ ë°©ì‹)
Client â†’ Apollo Server â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
                      â†’ DB ì¡°íšŒ
                      â†’ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í˜¸ì¶œ
ì´ ê²½ìš° Apollo Serverê°€:

ìŠ¤í‚¤ë§ˆ ì •ì˜
ë¦¬ì¡¸ë²„ êµ¬í˜„
DataLoaderë¡œ N+1 í•´ê²°
ì‹¤ì œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°

â†’ Strawberryë‘ ì™„ì „íˆ ë™ì¼í•œ ì—­í• 

2. Apollo Federation (Gateway)
ì´ê²Œ ë„¤ê°€ ë§í•œ "Nginx ê°™ì€" ì—­í• :
                    â”Œâ”€ Robot Subgraph (Apollo Server)
                    â”‚
Client â†’ Apollo     â”œâ”€ Telemetry Subgraph (Apollo Server)
         Gateway    â”‚
         (Router)   â””â”€ Alert Subgraph (Apollo Server)
Apollo Router (Rust) ë˜ëŠ” **Apollo Gateway (Node)**ê°€:

ì—¬ëŸ¬ ì„œë¸Œê·¸ë˜í”„ì˜ ìŠ¤í‚¤ë§ˆë¥¼ í•©ì¹¨
ì¿¼ë¦¬ë¥¼ ë¶„í•´í•´ì„œ ê° ì„œë¸Œê·¸ë˜í”„ë¡œ ë¼ìš°íŒ…
ê²°ê³¼ë¥¼ ì¡°í•©í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µ

â†’ ì´ê±´ Nginxë³´ë‹¤ëŠ” GraphQL ì „ìš© API Gateway

ìš°ë¦¬ í”„ë¡œì íŠ¸ì—ì„œëŠ”?
ì§€ê¸ˆ ì„¤ê³„í•œ êµ¬ì¡°
Client â†’ API Gateway (GraphQL) â†’ 3ê°œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ (REST)
Option 1: Apollo Server ë‹¨ë…
typescript// Apollo Serverê°€ ì§ì ‘ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í˜¸ì¶œ
const resolvers = {
  Query: {
    fleetDashboard: async () => {
      const robots = await fetch('http://robot-service:8001/robots');
      // ... ë‚˜ë¨¸ì§€ ë¡œì§
    }
  }
}
```

â†’ ì´ê±´ Strawberryë‘ ë˜‘ê°™ì€ ì—­í• 

---

**Option 2: Apollo Federation (ê³¼ì‰)**
```
Client â†’ Apollo Gateway 
           â”œâ”€ Robot Subgraph (Apollo Server) â†’ Robot Service
           â”œâ”€ Telemetry Subgraph (Apollo Server) â†’ Telemetry Service  
           â””â”€ Alert Subgraph (Apollo Server) â†’ Alert Service
```

â†’ ê° ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•ì— Apollo Server í•˜ë‚˜ì”© ë” ë¶™ì´ëŠ” ê±°
â†’ **ë„ˆë¬´ ë³µì¡í•¨, ë¶ˆí•„ìš”í•¨**

---

## Federationì´ í•„ìš”í•œ ê²½ìš°

### ì˜ˆì‹œ: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ ì´ë¯¸ GraphQLì¼ ë•Œ
```
ë§Œì•½ Robot Serviceê°€ GraphQLì„ ì§ì ‘ ì œê³µí•œë‹¤ë©´:

type Robot {
  id: ID!
  name: String!
}

type Query {
  robot(id: ID!): Robot
}
```

ì´ëŸ° ìƒí™©ì—ì„œ:
- Robot Service: GraphQL ìŠ¤í‚¤ë§ˆ ì œê³µ
- Telemetry Service: GraphQL ìŠ¤í‚¤ë§ˆ ì œê³µ  
- Alert Service: GraphQL ìŠ¤í‚¤ë§ˆ ì œê³µ

â†’ Apollo Federationì´ ì´ 3ê°œë¥¼ **í•˜ë‚˜ì˜ í†µí•© ìŠ¤í‚¤ë§ˆ**ë¡œ í•©ì³ì¤Œ

---

## ìš°ë¦¬ ê²½ìš°ëŠ”?

**ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ REST API ì œê³µ**
```
Robot Service: GET /robots/{id}
Telemetry Service: GET /telemetry/robots/{id}/latest
Alert Service: GET /alerts/robots/{id}
```

â†’ **Federation ë¶ˆí•„ìš”**
â†’ Apollo Server ë˜ëŠ” Strawberryê°€ **ë‹¨ë…ìœ¼ë¡œ REST í˜¸ì¶œí•˜ë©´ ë¨**

---

## ì •ë¦¬

| | Apollo Server | Apollo Federation |
|---|---|---|
| **ì—­í• ** | GraphQL ì‹¤í–‰ ì—”ì§„ | GraphQL ê²Œì´íŠ¸ì›¨ì´ (ì—¬ëŸ¬ GraphQL í†µí•©) |
| **ìœ ì‚¬ ì œí’ˆ** | Strawberry, GraphQL-Yoga | Kong, Nginx (ê°œë…ì ìœ¼ë¡œ) |
| **ìš°ë¦¬ í”„ë¡œì íŠ¸** | âœ… í•„ìš” (Gateway ì—­í• ) | âŒ ë¶ˆí•„ìš” (ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ REST) |

---

## ìµœì¢… ì•„í‚¤í…ì²˜ í™•ì •
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚
         â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ REST Gateway â”‚  â”‚ GraphQL GW   â”‚
â”‚  (FastAPI)   â”‚  â”‚ (Strawberry  â”‚ â† ë‹¨ë… ì„œë²„
â”‚              â”‚  â”‚  or Apollo)  â”‚   ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ REST í˜¸ì¶œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Microservices (3ê°œ)  â”‚
    â”‚  FastAPI (REST)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Apollo Federationì€ ë‚˜ì¤‘ì— ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ GraphQLì„ ì§ì ‘ ì œê³µí•˜ê²Œ ë˜ë©´ ê³ ë ¤í•˜ë©´ ë¼.
ì§€ê¸ˆì€ Strawberry (Python) ë˜ëŠ” Apollo Server (Node) ì¤‘ í•˜ë‚˜ë§Œ ì„ íƒí•´ì„œ
Gateway ì—­í• ë§Œ í•˜ë©´ ì¶©ë¶„í•´!
ì–´ë–»ê²Œ í• ê¹Œ?ê·¸ëŸ¼ ê°ì¢… ê²½ìš°ì˜ ìˆ˜ë¥¼ ì˜ ì •ë¦¬í•´ì¤˜ë´....ìš©ë„ë„ í—·ê°ˆë¦°ë‹¤2ì›” 4ì¼ì¢‹ì•„, ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ ëª…í™•í•˜ê²Œ ì •ë¦¬í•´ì¤„ê²Œ.

1. ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ API íƒ€ì…ë³„ ë¶„ë¥˜
Case A: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ REST API
Robot Service: GET /robots/{id}
Telemetry Service: GET /telemetry/robots/{id}/latest
Alert Service: GET /alerts/robots/{id}
â†’ ìš°ë¦¬ í”„ë¡œì íŠ¸ê°€ ì´ ì¼€ì´ìŠ¤
Case B: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ GraphQL API
Robot Service: query { robot(id: "123") { name } }
Telemetry Service: query { telemetry(robotId: "123") { battery } }
Alert Service: query { alerts(robotId: "123") { message } }

2. Gateway ì„ íƒì§€ë³„ ì •ë¦¬
Gateway ì¢…ë¥˜ìš©ë„ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íƒ€ì…ì˜ˆì‹œREST GatewayREST â†’ REST ë¼ìš°íŒ…RESTNginx, Kong, FastAPIGraphQL ServerGraphQL â†’ REST í˜¸ì¶œRESTApollo Server, StrawberryGraphQL FederationGraphQL â†’ GraphQL í†µí•©GraphQLApollo Router, Apollo Gateway

3. ê° ì¼€ì´ìŠ¤ë³„ ìƒì„¸ ì„¤ëª…
ğŸ“Œ Case 1: REST Gateway + REST Services
Client â†’ REST Gateway (FastAPI) â†’ REST Services
êµ¬ì¡°:
python# FastAPI Gateway
@app.get("/api/fleet/dashboard")
async def fleet_dashboard():
    robots = await http_client.get("http://robot-service/robots")
    telemetry = await http_client.get("http://telemetry-service/...")
    alerts = await http_client.get("http://alert-service/...")
    return aggregate(robots, telemetry, alerts)
```

**íŠ¹ì§•:**
- âœ… ê°„ë‹¨í•¨
- âŒ N+1 ë¬¸ì œ ìˆ˜ë™ í•´ê²° í•„ìš”
- âŒ Over-fetching í•´ê²° ë¶ˆê°€
- **ìš©ë„:** ë‹¨ìˆœ ë¼ìš°íŒ…, ë ˆê±°ì‹œ í†µí•©

---

### ğŸ“Œ Case 2: GraphQL Server + REST Services (â˜… ìš°ë¦¬ ì¼€ì´ìŠ¤)
```
Client â†’ GraphQL Gateway â†’ REST Services
              (Apollo or Strawberry)
êµ¬ì¡° (Strawberry):
python@strawberry.type
class Query:
    @strawberry.field
    async def fleet_dashboard(self) -> FleetDashboard:
        robots = await fetch_robots()  # REST í˜¸ì¶œ
        return FleetDashboard(robots=robots)

@strawberry.type
class Robot:
    id: str
    name: str
    
    @strawberry.field
    async def latest_telemetry(self) -> Telemetry:
        # DataLoaderë¡œ ë°°ì¹˜ ì²˜ë¦¬
        return await telemetry_loader.load(self.id)
```

**íŠ¹ì§•:**
- âœ… N+1 ë¬¸ì œ ìë™ í•´ê²° (DataLoader)
- âœ… Over-fetching í•´ê²° (í´ë¼ì´ì–¸íŠ¸ê°€ í•„ë“œ ì„ íƒ)
- âœ… ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸
- **ìš©ë„:** RESTë¥¼ GraphQLë¡œ ë˜í•‘, N+1 ìµœì í™”

**Apollo vs Strawberry ë¹„êµ:**
| | Apollo Server | Strawberry |
|---|---|---|
| ì–¸ì–´ | Node.js/TypeScript | Python |
| ìŠ¤í‚¤ë§ˆ ì •ì˜ | SDL (Schema First) | ë°ì½”ë ˆì´í„° (Code First) |
| ì„¤ì¹˜ | `npm install @apollo/server` | `pip install strawberry-graphql` |
| ë°±ì—”ë“œ í†µí•© | Express, Fastify | FastAPI, Django |
| DataLoader | ë³„ë„ ì„¤ì¹˜ í•„ìš” | ë‚´ì¥ |
| ëª¨ë‹ˆí„°ë§ | Apollo Studio (ë¬´ë£Œ) | ìˆ˜ë™ (Prometheus) |

---

### ğŸ“Œ Case 3: GraphQL Federation + GraphQL Services
```
Client â†’ Apollo Router â†’ Subgraph 1 (Apollo Server) â†’ Service 1
                      â†’ Subgraph 2 (Apollo Server) â†’ Service 2
                      â†’ Subgraph 3 (Apollo Server) â†’ Service 3
êµ¬ì¡°:
typescript// Robot Subgraph
const typeDefs = gql`
  type Robot @key(fields: "id") {
    id: ID!
    name: String!
  }
`;

// Telemetry Subgraph (Robot í™•ì¥)
const typeDefs = gql`
  extend type Robot @key(fields: "id") {
    id: ID! @external
    latestTelemetry: Telemetry
  }
`;

// Apollo Routerê°€ ì´ ë‘˜ì„ ìë™ìœ¼ë¡œ í•©ì¹¨
```

**íŠ¹ì§•:**
- âœ… ê° íŒ€ì´ ë…ë¦½ì ìœ¼ë¡œ ìŠ¤í‚¤ë§ˆ ê´€ë¦¬
- âœ… ìŠ¤í‚¤ë§ˆ ìë™ í†µí•©
- âš ï¸ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ GraphQLì´ì–´ì•¼ í•¨
- âš ï¸ ë³µì¡ë„ ë†’ìŒ (Subgraphë§ˆë‹¤ Apollo Server í•„ìš”)
- **ìš©ë„:** ëŒ€ê·œëª¨ ì¡°ì§, íŒ€ë³„ GraphQL ì„œë¹„ìŠ¤

---

## 4. ìš°ë¦¬ í”„ë¡œì íŠ¸ ê²½ìš°ì˜ ìˆ˜

### Option A: RESTë§Œ (ë² ì´ìŠ¤ë¼ì¸)
```
Client â†’ FastAPI Gateway â†’ REST Services
```
- ì„±ëŠ¥ ë¹„êµ ëŒ€ìƒ
- N+1 ë¬¸ì œ ê·¸ëŒ€ë¡œ ë°œìƒ

---

### Option B: Strawberry (ì¶”ì²œ â­)
```
Client â†’ Strawberry + FastAPI â†’ REST Services
python# main.py
from fastapi import FastAPI
from strawberry.fastapi import GraphQLRouter
import strawberry

app = FastAPI()

@strawberry.type
class Query:
    @strawberry.field
    async def robots(self) -> list[Robot]:
        return await fetch_robots_from_rest()

schema = strawberry.Schema(query=Query)
graphql_app = GraphQLRouter(schema)
app.include_router(graphql_app, prefix="/graphql")
```

**ì¥ì :**
- Python ë‹¨ì¼ ì–¸ì–´
- FastAPIì™€ ì™„ë²½ í†µí•©
- ëŸ¬ë‹ì»¤ë¸Œ ë‚®ìŒ
- DataLoader ë‚´ì¥

---

### Option C: Apollo Server
```
Client â†’ Apollo Server (Node.js) â†’ REST Services
typescript// server.ts
import { ApolloServer } from '@apollo/server';
import { startStandaloneServer } from '@apollo/server/standalone';

const typeDefs = `#graphql
  type Query {
    robots: [Robot]
  }
  type Robot {
    id: ID!
    name: String!
  }
`;

const resolvers = {
  Query: {
    robots: async () => {
      const response = await fetch('http://robot-service:8001/robots');
      return response.json();
    }
  }
};

const server = new ApolloServer({ typeDefs, resolvers });
const { url } = await startStandaloneServer(server);
```

**ì¥ì :**
- Apollo Studio ë¬´ë£Œ ëª¨ë‹ˆí„°ë§
- ê°•ë ¥í•œ ìƒíƒœê³„
- TypeScript íƒ€ì… ì•ˆì •ì„±

**ë‹¨ì :**
- Node.js ì¶”ê°€ í•„ìš”
- ë°±ì—”ë“œì™€ ì–¸ì–´ ë¶„ë¦¬

---

### Option D: Apollo Federation (ê³¼ì‰)
```
Client â†’ Apollo Router 
           â†’ Robot Subgraph (Apollo) â†’ Robot Service (GraphQL)
           â†’ Telemetry Subgraph (Apollo) â†’ Telemetry Service (GraphQL)
           â†’ Alert Subgraph (Apollo) â†’ Alert Service (GraphQL)
```

**ë¬¸ì œì :**
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ GraphQLë¡œ ë‹¤ì‹œ ë§Œë“¤ì–´ì•¼ í•¨
- ê° ì„œë¹„ìŠ¤ë§ˆë‹¤ Apollo Server ì¶”ê°€
- **ì™„ì „íˆ ë¶ˆí•„ìš”í•œ ë³µì¡ë„**

---

## 5. ìµœì¢… ì¶”ì²œ êµ¬ì¡°

### ğŸ¯ ì¶”ì²œ ì•„í‚¤í…ì²˜
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Performance Test Client           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REST Endpoint   â”‚  â”‚ GraphQL Endpoint â”‚
â”‚                  â”‚  â”‚                  â”‚
â”‚  FastAPI         â”‚  â”‚  Strawberry      â”‚
â”‚  /api/rest/*     â”‚  â”‚  /graphql        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Microservices       â”‚
        â”‚                       â”‚
        â”‚  Robot Service :8001  â”‚
        â”‚  Telemetry Service    â”‚
        â”‚  Alert Service        â”‚
        â”‚                       â”‚
        â”‚  (ëª¨ë‘ FastAPI REST)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      PostgreSQL       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

6. ì •ë¦¬í‘œ
êµ¬ì„± ìš”ì†ŒREST ë²„ì „GraphQL ë²„ì „GatewayFastAPI /api/rest/*Strawberry /graphqlìŠ¤í‚¤ë§ˆ ì •ì˜OpenAPI (ìë™)GraphQL Schema (ë°ì½”ë ˆì´í„°)N+1 í•´ê²°ìˆ˜ë™ (ë°°ì¹˜ ì¿¼ë¦¬ ì§ì ‘ êµ¬í˜„)DataLoader (ìë™)Over-fetchingì „ì²´ ì‘ë‹µí•„ë“œ ì„ íƒ ê°€ëŠ¥ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤FastAPI (ë™ì¼)FastAPI (ë™ì¼)ë°ì´í„°ë² ì´ìŠ¤PostgreSQL (ë™ì¼)PostgreSQL (ë™ì¼)

7. êµ¬í˜„ ìˆœì„œ

ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ 3ê°œ êµ¬í˜„ (FastAPI REST)

Robot Service
Telemetry Service
Alert Service


REST Gateway êµ¬í˜„ (FastAPI)

3ê°œ í´ë¼ì´ì–¸íŠ¸ API êµ¬í˜„
N+1 ë¬¸ì œ ê·¸ëŒ€ë¡œ ë‘ê¸°


GraphQL Gateway êµ¬í˜„ (Strawberry)

ë™ì¼í•œ 3ê°œ APIë¥¼ GraphQLë¡œ
DataLoaderë¡œ N+1 í•´ê²°


ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

Locust / k6ë¡œ ë¶€í•˜ í…ŒìŠ¤íŠ¸
ë‚´ë¶€ í˜¸ì¶œ íšŸìˆ˜ ë¹„êµ
ì‘ë‹µ ì‹œê°„ ë¹„êµ




ì´ì œ ëª…í™•í•´?

Apollo Federationì€ ìš°ë¦¬í•œí…Œ ë¶ˆí•„ìš”
Strawberryë¡œ GraphQL Gatewayë§Œ ë§Œë“¤ë©´ ë¨
ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ëŠ” ê·¸ëƒ¥ RESTë¡œ ìœ ì§€

êµ¬í˜„ ì‹œì‘í• ê¹Œ?ê·¸ëŸ¼ ìŠ¤íŠ¸ë¡œë² ë¦¬ì“°ê³  ë’·ë‹¨ ì„œë¹„ìŠ¤ëŠ” ë ˆìŠ¤íŠ¸ë©´ ê·¸ë˜í”„íì—˜ì„ ì™œ ì“°ëŠ”ê±°ì§€?2ì›” 4ì¼ì•„ í•µì‹¬ ì§ˆë¬¸ì´ë‹¤! ì´ê²Œ ë§ì´ í—·ê°ˆë¦¬ëŠ” ë¶€ë¶„ì´ì•¼.

ì™œ ë’·ë‹¨ì´ RESTì¸ë° GraphQLì„ ì“°ëƒ?
ë¬¸ì œ ìƒí™© ì¬í™•ì¸
í”Œë¦¿ ëŒ€ì‹œë³´ë“œ API í˜¸ì¶œ:
Client: "15ëŒ€ ë¡œë´‡ ì •ë³´ + ê°ê°ì˜ ìµœì‹  í…”ë ˆë©”íŠ¸ë¦¬ + ì•ŒëŒ ì¤˜"

Case 1: REST Gateway (í˜„ì¬)
í´ë¼ì´ì–¸íŠ¸ â†’ Gateway í†µì‹ :
httpGET /api/fleet/dashboard
Gateway â†’ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í†µì‹  (ë‚´ë¶€):
python# Gateway ë‚´ë¶€ ë¡œì§
async def fleet_dashboard():
    robots = await get("http://robot-service/robots")  # 1ë²ˆ
    
    result = []
    for robot in robots:  # 15ëŒ€
        # N+1 ë¬¸ì œ!
        tele = await get(f"http://telemetry-service/robots/{robot.id}/latest")  # 15ë²ˆ
        alerts = await get(f"http://alert-service/robots/{robot.id}")  # 15ë²ˆ
        result.append({
            "robot": robot,
            "telemetry": tele,
            "alerts": alerts
        })
    return result

# ì´ ë‚´ë¶€ í˜¸ì¶œ: 1 + 15 + 15 = 31ë²ˆ
ë¬¸ì œì :

Gatewayê°€ ë°˜ë³µë¬¸ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œ
N+1 ë¬¸ì œë¥¼ ìˆ˜ë™ìœ¼ë¡œ í•´ê²°í•´ì•¼ í•¨ (ë°°ì¹˜ ì¿¼ë¦¬ ì§ì ‘ êµ¬í˜„)


Case 2: GraphQL Gateway (Strawberry)
í´ë¼ì´ì–¸íŠ¸ â†’ Gateway í†µì‹ :
graphqlquery {
  fleetDashboard {
    robots {
      id
      name
      latestTelemetry { battery }
      activeAlerts { message }
    }
  }
}
Gateway â†’ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í†µì‹  (ë‚´ë¶€):
pythonfrom strawberry.dataloader import DataLoader

# DataLoader ì •ì˜
async def load_telemetry(robot_ids: list[str]):
    # í•œë²ˆì— ë°°ì¹˜ ì¡°íšŒ!
    response = await post(
        "http://telemetry-service/batch-query",
        json={"robot_ids": robot_ids}
    )
    return response.json()

telemetry_loader = DataLoader(load_fn=load_telemetry)

# GraphQL ë¦¬ì¡¸ë²„
@strawberry.type
class Robot:
    id: str
    name: str
    
    @strawberry.field
    async def latest_telemetry(self) -> Telemetry:
        # DataLoaderê°€ ìë™ìœ¼ë¡œ ë°°ì¹˜ ì²˜ë¦¬!
        # 15ê°œ ìš”ì²­ì„ ëª¨ì•„ì„œ í•œë²ˆì— í˜¸ì¶œ
        return await telemetry_loader.load(self.id)

# ì´ ë‚´ë¶€ í˜¸ì¶œ: 1(robots) + 1(telemetry batch) + 1(alerts batch) = 3ë²ˆ

í•µì‹¬ ì°¨ì´: DataLoaderì˜ ë§ˆë²•
REST Gateway - ìˆœì§„í•œ ë°˜ë³µë¬¸
pythonfor robot in robots:  # 15ë²ˆ ë°˜ë³µ
    tele = await call_service(robot.id)  # ë§¤ë²ˆ ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ
GraphQL Gateway - ë˜‘ë˜‘í•œ ë°°ì¹˜ ì²˜ë¦¬
python# DataLoaderê°€ ë‚´ë¶€ì—ì„œ ìë™ìœ¼ë¡œ:
# 1. ì—¬ëŸ¬ ê°œì˜ load(robot.id) ìš”ì²­ì„ ìˆ˜ì§‘ (ë²„í¼ë§)
# 2. ì´ë²¤íŠ¸ ë£¨í”„ì˜ ë‹¤ìŒ í‹±ì—ì„œ í•œë²ˆì— ì²˜ë¦¬
# 3. ë°°ì¹˜ API í˜¸ì¶œ: [id1, id2, ..., id15]
# 4. ê²°ê³¼ë¥¼ ê° ìš”ì²­ìì—ê²Œ ë¶„ë°°
```

---

## ë¹„ìœ ë¡œ ì„¤ëª…

### ğŸª í¸ì˜ì  ë°°ë‹¬ (REST Gateway)
```
ì†ë‹˜ 15ëª…ì´ ê°ì "ë¬¼ 1ê°œì”© ì£¼ë¬¸"

ë°°ë‹¬ì›ì´ 15ë²ˆ ì™•ë³µ:
- 1ë²ˆì§¸: Aì—ê²Œ ë¬¼ ë°°ë‹¬
- 2ë²ˆì§¸: Bì—ê²Œ ë¬¼ ë°°ë‹¬
- ...
- 15ë²ˆì§¸: Oì—ê²Œ ë¬¼ ë°°ë‹¬

ì´ 15ë²ˆ ë°°ë‹¬
```

### ğŸšš ëŒ€í˜•ë§ˆíŠ¸ ë°°ë‹¬ (GraphQL DataLoader)
```
ì†ë‹˜ 15ëª…ì´ ê°ì "ë¬¼ 1ê°œì”© ì£¼ë¬¸"

ë°°ë‹¬ì›ì´ ì ê¹ ê¸°ë‹¤ë ¸ë‹¤ê°€:
- "ì•„ 15ëª…ì´ ì£¼ë¬¸í–ˆë„¤? í•œë²ˆì— ëª¨ì•„ì„œ ë°°ë‹¬í•˜ì"
- íŠ¸ëŸ­ì— ë¬¼ 15ê°œ ì‹£ê³  í•œë²ˆì— ë°°ë‹¬

ì´ 1ë²ˆ ë°°ë‹¬

ì‹¤ì œ ì½”ë“œë¡œ ëª…í™•í•˜ê²Œ ë¹„êµ
REST Gateway êµ¬í˜„
python@app.get("/api/fleet/dashboard")
async def fleet_dashboard():
    robots = await http.get("http://robot-service/robots")
    
    # ğŸ˜­ ì´ë ‡ê²Œ í•˜ë©´ N+1
    for robot in robots:
        robot["telemetry"] = await http.get(
            f"http://telemetry-service/robots/{robot['id']}/latest"
        )
    
    # âœ… ì´ë ‡ê²Œ í•´ì•¼ ìµœì í™” (ìˆ˜ë™)
    robot_ids = [r["id"] for r in robots]
    telemetry_map = await http.post(
        "http://telemetry-service/batch-query",
        json={"robot_ids": robot_ids}
    )
    for robot in robots:
        robot["telemetry"] = telemetry_map[robot["id"]]
    
    return robots
â†’ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ê°œë°œìê°€ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•¨

GraphQL Gateway êµ¬í˜„
python# DataLoader í•œë²ˆë§Œ ì •ì˜
telemetry_loader = DataLoader(load_fn=load_telemetry_batch)

@strawberry.type
class Robot:
    id: str
    
    @strawberry.field
    async def latest_telemetry(self) -> Telemetry:
        # ê·¸ëƒ¥ load í˜¸ì¶œë§Œ í•˜ë©´ ë
        # DataLoaderê°€ ì•Œì•„ì„œ ë°°ì¹˜ ì²˜ë¦¬
        return await telemetry_loader.load(self.id)
â†’ ë°°ì¹˜ ì²˜ë¦¬ê°€ ìë™ìœ¼ë¡œ ë¨

ì¶”ê°€ ì´ì 
1. Over-fetching í•´ê²°
REST:
json// í´ë¼ì´ì–¸íŠ¸ê°€ ë¡œë´‡ ì´ë¦„ë§Œ í•„ìš”í•´ë„ ì „ì²´ ë°ì´í„° ì „ì†¡
{
  "id": "robot-001",
  "name": "Robot-A",
  "model": "AGV-X200",          // ë¶ˆí•„ìš”
  "location": "Building-3",     // ë¶ˆí•„ìš”
  "firmware_version": "v2.3.1", // ë¶ˆí•„ìš”
  "status": "active"            // ë¶ˆí•„ìš”
}
GraphQL:
graphql# í•„ìš”í•œ ê²ƒë§Œ ìš”ì²­
query {
  robots {
    name  # ì´ê²ƒë§Œ ì „ì†¡ë¨
  }
}

2. Under-fetching í•´ê²°
REST:
httpGET /api/robots           # 1ë²ˆ - ë¡œë´‡ ëª©ë¡
GET /api/users/me         # 2ë²ˆ - ë‚´ ì •ë³´
GET /api/alerts/active    # 3ë²ˆ - í™œì„± ì•ŒëŒ

í´ë¼ì´ì–¸íŠ¸ê°€ 3ë²ˆ í˜¸ì¶œí•´ì•¼ í•¨
GraphQL:
graphqlquery {
  robots { name }
  me { email }
  activeAlerts { message }
}

í´ë¼ì´ì–¸íŠ¸ê°€ 1ë²ˆë§Œ í˜¸ì¶œ
```

---

## ê·¸ë˜ì„œ ë‹µì€?

### GraphQLì„ ì“°ëŠ” ì´ìœ  (ë’·ë‹¨ì´ RESTì—¬ë„)

| ë¬¸ì œ | REST Gateway | GraphQL Gateway |
|------|-------------|----------------|
| **N+1 ë¬¸ì œ** | ìˆ˜ë™ í•´ê²° (ë³µì¡) | DataLoader ìë™ í•´ê²° |
| **Over-fetching** | í•­ìƒ ì „ì²´ ì „ì†¡ | í•„ìš”í•œ í•„ë“œë§Œ |
| **Under-fetching** | ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œ | í•œë²ˆì— í•´ê²° |
| **í´ë¼ì´ì–¸íŠ¸ ìœ ì—°ì„±** | ê³ ì •ëœ ì‘ë‹µ | ì¿¼ë¦¬ë¡œ ì œì–´ |

---

## ê²°ë¡ 

**GraphQL GatewayëŠ”:**
- âŒ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ GraphQLë¡œ ë°”ê¾¸ëŠ” ê²Œ ì•„ë‹ˆë¼
- âœ… REST ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ **ë˜‘ë˜‘í•˜ê²Œ ì¡°í•©**í•˜ëŠ” ê³„ì¸µ

**ì‰½ê²Œ ë§í•˜ë©´:**
```
REST ì„œë¹„ìŠ¤: "ì¬ë£Œ ì°½ê³ " (ê°œë³„ ë°ì´í„° ì œê³µ)
GraphQL Gateway: "ë˜‘ë˜‘í•œ ì…°í”„" (íš¨ìœ¨ì ìœ¼ë¡œ ì¡°í•©í•´ì„œ ìš”ë¦¬)
ì´ì œ ì´í•´ëì–´? GraphQLì€ ë’·ë‹¨ API í˜¸ì¶œì„ ìµœì í™”í•˜ë ¤ê³  ì“°ëŠ” ê±°ì•¼!

** User **
ê·¸ëŸ¼ ì•„í´ë¡œë¼ìš°í„°ë‘ ìŠ¤íŠ¸ë¡œë² ë¦¬ë‘ ì¢€ ê²¹ì¹˜ëŠ”ê±°ì§€?

** AI System **
ì•„! ì •í™•í•œ ì§ˆë¬¸ì´ì•¼. ê·¼ë° ê²¹ì¹˜ì§€ ì•Šì•„. ì™„ì „íˆ ë‹¤ë¥¸ ìš©ë„ì•¼.

Apollo Router vs Strawberry
StrawberryApollo Routerì—­í• GraphQL ì„œë²„ (ì‹¤í–‰ ì—”ì§„)GraphQL ê²Œì´íŠ¸ì›¨ì´ (ë¼ìš°í„°)ì…ë ¥GraphQL ì¿¼ë¦¬ ë°›ìŒGraphQL ì¿¼ë¦¬ ë°›ìŒì¶œë ¥REST API í˜¸ì¶œí•´ì„œ ì‘ë‹µë‹¤ë¥¸ GraphQL ì„œë²„ë“¤ í˜¸ì¶œí•´ì„œ í†µí•©ë¹„ìœ ìš”ë¦¬ì‚¬ (ì¬ë£Œë¥¼ ìš”ë¦¬)ìŒì‹ì  ì´ê´„ ë§¤ë‹ˆì € (ì—¬ëŸ¬ ìš”ë¦¬ì‚¬ ê´€ë¦¬)

êµ¬ì²´ì ì¸ ì°¨ì´
Strawberry (GraphQL Server)
Client â†’ Strawberry
           â†“
        [GraphQL ì¿¼ë¦¬ ì‹¤í–‰]
           â†“
        REST API í˜¸ì¶œ
           â†“
        Robot Service (REST)
        Telemetry Service (REST)
        Alert Service (REST)
Strawberryê°€ í•˜ëŠ” ì¼:
python@strawberry.type
class Query:
    @strawberry.field
    async def robot(self, id: str) -> Robot:
        # ì§ì ‘ REST API í˜¸ì¶œ
        response = await http.get(f"http://robot-service/robots/{id}")
        return Robot(**response.json())
```

â†’ **GraphQL ì¿¼ë¦¬ë¥¼ ë°›ì•„ì„œ RESTë¡œ ë³€í™˜**

---

### Apollo Router (Federation Gateway)
```
Client â†’ Apollo Router
           â†“
        [ì¿¼ë¦¬ ë¶„ì„ ë° ë¶„í•´]
           â†“
        ì—¬ëŸ¬ GraphQL Subgraphë¡œ ë¶„ì‚°
           â†“
        Robot Subgraph (GraphQL)
        Telemetry Subgraph (GraphQL)
        Alert Subgraph (GraphQL)
           â†“
        [ì‘ë‹µ í†µí•©]
           â†“
        Clientì—ê²Œ ë°˜í™˜
```

**Apollo Routerê°€ í•˜ëŠ” ì¼:**
```
í´ë¼ì´ì–¸íŠ¸ ì¿¼ë¦¬:
query {
  robot(id: "123") {
    name              # â†’ Robot Subgraphë¡œ
    latestTelemetry { # â†’ Telemetry Subgraphë¡œ
      battery
    }
  }
}

Apollo Router ë‚´ë¶€:
1. ì¿¼ë¦¬ ë¶„ì„: "ì•„, robot.nameì€ Robot Subgraph, telemetryëŠ” Telemetry Subgraph"
2. ê° Subgraphì— ì¿¼ë¦¬ ì „ì†¡ (GraphQL â†’ GraphQL)
3. ì‘ë‹µ ì¡°í•©í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜
```

â†’ **GraphQLì„ ì—¬ëŸ¬ GraphQLë¡œ ë¶„ì‚°í•˜ê³  í†µí•©**

---

## í•µì‹¬ ì°¨ì´: ë’·ë‹¨ì´ ë­ëƒ?

| Gateway | ë’·ë‹¨ ì„œë¹„ìŠ¤ íƒ€ì… | í†µì‹  ë°©ì‹ |
|---------|----------------|----------|
| **Strawberry** | REST API | GraphQL â†’ REST ë³€í™˜ |
| **Apollo Router** | GraphQL API | GraphQL â†’ GraphQL ë¼ìš°íŒ… |

---

## ì‹œê°ì  ë¹„êµ

### Strawberry ì•„í‚¤í…ì²˜ (ìš°ë¦¬ í”„ë¡œì íŠ¸)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚ GraphQL Query
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Strawberry     â”‚ â—„â”€â”€ ì´ê²Œ "GraphQL Server"
â”‚  (GraphQL ì‹¤í–‰)  â”‚     ë¦¬ì¡¸ë²„ì—ì„œ ì§ì ‘ REST í˜¸ì¶œ
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ HTTP REST
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Robot Service    â”‚ REST API
â”‚ Telemetry Serviceâ”‚ REST API
â”‚ Alert Service    â”‚ REST API
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Apollo Router ì•„í‚¤í…ì²˜ (Federation)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚ GraphQL Query
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Apollo Router   â”‚ â—„â”€â”€ ì´ê²Œ "Gateway" (ë¼ìš°í„°)
â”‚  (ì¿¼ë¦¬ ë¶„ì‚°ê¸°)    â”‚     GraphQLì„ GraphQLë¡œ ë¼ìš°íŒ…ë§Œ
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ GraphQL (Federation Protocol)
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Robot Subgraph   â”‚ â—„â”€â”€ ì´ê²ƒë„ GraphQL Server (Apollo Server)
â”‚  (Apollo Server) â”‚     Robot Service(REST) í˜¸ì¶œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Telemetry Sub    â”‚ â—„â”€â”€ ì´ê²ƒë„ GraphQL Server
â”‚  (Apollo Server) â”‚     Telemetry Service(REST) í˜¸ì¶œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â†’ Apollo Router ë’¤ì—ë„ ê²°êµ­ GraphQL Serverê°€ ìˆìŒ!

ì‹¤ì œ ì½”ë“œ ë¹„êµ
Strawberry ë°©ì‹ (1ê°œ ì„œë²„)
python# ì „ì²´ê°€ í•˜ë‚˜ì˜ ì„œë²„
from strawberry.fastapi import GraphQLRouter

@strawberry.type
class Query:
    @strawberry.field
    async def robot(self, id: str) -> Robot:
        # ì—¬ê¸°ì„œ ì§ì ‘ REST í˜¸ì¶œ
        data = await fetch_from_rest_api(f"/robots/{id}")
        return Robot(**data)
    
    @strawberry.field
    async def telemetry(self, robot_id: str) -> Telemetry:
        # ì—¬ê¸°ì„œ ì§ì ‘ REST í˜¸ì¶œ
        data = await fetch_from_rest_api(f"/telemetry/{robot_id}")
        return Telemetry(**data)

schema = strawberry.Schema(query=Query)
app = FastAPI()
app.include_router(GraphQLRouter(schema), prefix="/graphql")
â†’ í•˜ë‚˜ì˜ ì„œë²„ì—ì„œ ëª¨ë“  íƒ€ì… ì²˜ë¦¬

Apollo Federation ë°©ì‹ (ì—¬ëŸ¬ ì„œë²„)
Robot Subgraph (ë³„ë„ ì„œë²„ 1):
typescript// í¬íŠ¸ 4001
const typeDefs = gql`
  type Robot @key(fields: "id") {
    id: ID!
    name: String!
  }
  
  type Query {
    robot(id: ID!): Robot
  }
`;

const resolvers = {
  Query: {
    robot: (_, { id }) => {
      // ì—¬ê¸°ì„œ Robot Service(REST) í˜¸ì¶œ
      return fetch(`http://robot-service/robots/${id}`);
    }
  }
};
Telemetry Subgraph (ë³„ë„ ì„œë²„ 2):
typescript// í¬íŠ¸ 4002
const typeDefs = gql`
  extend type Robot @key(fields: "id") {
    id: ID! @external
    latestTelemetry: Telemetry
  }
  
  type Telemetry {
    battery: Float
  }
`;

const resolvers = {
  Robot: {
    latestTelemetry: (robot) => {
      // ì—¬ê¸°ì„œ Telemetry Service(REST) í˜¸ì¶œ
      return fetch(`http://telemetry-service/robots/${robot.id}/latest`);
    }
  }
};
Apollo Router (í†µí•©):
yaml# router.yaml
supergraph:
  subgraphs:
    robot:
      url: http://localhost:4001
    telemetry:
      url: http://localhost:4002
```

â†’ **ì—¬ëŸ¬ GraphQL ì„œë²„ë¥¼ Routerê°€ í†µí•©**

---

## ì–¸ì œ ë­˜ ì“°ë‚˜?

### Strawberry ì“¸ ë•Œ (ìš°ë¦¬ ì¼€ì´ìŠ¤)
```
âœ… ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ REST
âœ… ë‹¨ì¼ íŒ€ì´ ì „ì²´ ê´€ë¦¬
âœ… ê°„ë‹¨í•œ êµ¬ì¡° ì›í•¨
âœ… Python ë°±ì—”ë“œ
```

**ì¥ì :**
- ê°„ë‹¨í•¨ (ì„œë²„ 1ê°œ)
- ë¹ ë¥¸ ê°œë°œ
- ìš´ì˜ ë³µì¡ë„ ë‚®ìŒ

---

### Apollo Router ì“¸ ë•Œ
```
âœ… ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ ì´ë¯¸ GraphQL
âœ… ì—¬ëŸ¬ íŒ€ì´ ê°ì ìŠ¤í‚¤ë§ˆ ê´€ë¦¬
âœ… ìŠ¤í‚¤ë§ˆ ìë™ í†µí•© í•„ìš”
âœ… ëŒ€ê·œëª¨ ì¡°ì§
```

**ì¥ì :**
- íŒ€ë³„ ë…ë¦½ ê°œë°œ
- ìŠ¤í‚¤ë§ˆ ìë™ ë³‘í•©
- í™•ì¥ì„± ë†’ìŒ

**ë‹¨ì :**
- ë³µì¡í•¨ (ì„œë²„ N+1ê°œ)
- ìš´ì˜ ë¶€ë‹´
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ GraphQLë¡œ ë§Œë“¤ì–´ì•¼ í•¨

---

## ë¹„ìœ ë¡œ ì •ë¦¬

### Strawberry
```
í˜¼ì í•˜ëŠ” ì‹ë‹¹
- ì…°í”„ 1ëª…ì´ ëª¨ë“  ìš”ë¦¬ ë‹´ë‹¹
- ì¬ë£Œ ì°½ê³ (REST ì„œë¹„ìŠ¤)ì—ì„œ ì¬ë£Œ ê°€ì ¸ì™€ì„œ ìš”ë¦¬
- ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì 
```

### Apollo Router + Subgraphs
```
í‘¸ë“œì½”íŠ¸
- ê° ë§¤ì¥(Subgraph)ì´ GraphQLë¡œ ë©”ë‰´ ì œê³µ
- ì´ê´„ ë°ìŠ¤í¬(Router)ê°€ ì£¼ë¬¸ ë¶„ì‚°
- ê° ë§¤ì¥ë„ ê²°êµ­ ì¬ë£Œ ì°½ê³ (REST)ì—ì„œ ì¬ë£Œ ê°€ì ¸ì˜´
- ë³µì¡í•˜ì§€ë§Œ ê·œëª¨ í™•ì¥ì— ìœ ë¦¬

ìµœì¢… ì •ë¦¬
ì§ˆë¬¸ë‹µë³€Strawberryë‘ Apollo Router ê²¹ì³?âŒ ì™„ì „íˆ ë‹¤ë¥¸ ì—­í• StrawberryëŠ”?GraphQL ì„œë²„ (REST í˜¸ì¶œ)Apollo RouterëŠ”?GraphQL ê²Œì´íŠ¸ì›¨ì´ (GraphQL í†µí•©)ìš°ë¦¬ í”„ë¡œì íŠ¸ëŠ”?Strawberryë§Œ í•„ìš”Apollo Router í•„ìš”í•œ ê²½ìš°?ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ GraphQLì¼ ë•Œ

í•œ ë¬¸ì¥ ìš”ì•½:
StrawberryëŠ” "GraphQL ìš”ë¦¬ì‚¬" (RESTë¥¼ GraphQLë¡œ ë³€í™˜)
Apollo RouterëŠ” "í‘¸ë“œì½”íŠ¸ ê´€ë¦¬ì" (ì—¬ëŸ¬ GraphQLì„ í†µí•©)
ì´ì œ ëª…í™•í•´? ìš°ë¦¬ëŠ” Strawberryë§Œ ì“°ë©´ ë¼!

** User **
ê·¸ê·¸ëŸ¼ ë‹¤ì‹œí•œë²ˆ ê²½ìš°ì˜ìˆ˜ë“¤ì„ ì¤˜ë´...ì†”ë£¨ì…˜ë§ˆë‹¤ ì •ì˜ë‚˜ ìš©ë„ë¥¼ ë¨¼ì € ì •ì˜í•œë‹¤ìŒì—... ì½”ë“œëŠ” ì•ˆë³´ì—¬ì¤˜ë„ ê´œì°®ê³ , ë ˆì´ì–´ë³„ë¡œ í˜¸ì¶œê·¸ëŸ°ê±°ë§Œ ì¢€ ì•Œë ¤ì¤˜ë´. ê·¸ë¦¼ ë§ì´ ê·¸ë¦¬ì§€ë§ê³  -> ì´ëŸ° í™”ì‚´í‘œì´ìš©í•´ì„œ í”Œë¡œìš°ë§Œ ê·¸ë¦¬ê³ 

** AI System **
ì¢‹ì•„, ê¹”ë”í•˜ê²Œ ì •ë¦¬í•´ì¤„ê²Œ.


ì†”ë£¨ì…˜ë³„ ì •ì˜ ë° ìš©ë„
1. REST Gateway
ì •ì˜: HTTP REST ì—”ë“œí¬ì¸íŠ¸ë¡œ ìš”ì²­ì„ ë°›ì•„ REST ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¼ìš°í„°
ìš©ë„: ë‹¨ìˆœ í”„ë¡ì‹œ, API í†µí•©, ì¸ì¦/ë¡œê¹… ì¶”ê°€
ì˜ˆì‹œ: Nginx, Kong, FastAPI

2. GraphQL Server (Strawberry, Apollo Server)
ì •ì˜: GraphQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê³  ë¦¬ì¡¸ë²„ì—ì„œ ì§ì ‘ ë°ì´í„° ì†ŒìŠ¤(REST/DB)ë¥¼ í˜¸ì¶œí•˜ëŠ” ì„œë²„
ìš©ë„: RESTë¥¼ GraphQLë¡œ ë˜í•‘, N+1 ë¬¸ì œ í•´ê²°, Over-fetching ë°©ì§€
ì˜ˆì‹œ: Strawberry, Apollo Server, GraphQL Yoga

3. GraphQL Federation Gateway (Apollo Router)
ì •ì˜: ì—¬ëŸ¬ GraphQL ì„œë²„(Subgraph)ì˜ ìŠ¤í‚¤ë§ˆë¥¼ í†µí•©í•˜ê³  ì¿¼ë¦¬ë¥¼ ë¶„ì‚°/ë¼ìš°íŒ…í•˜ëŠ” ê²Œì´íŠ¸ì›¨ì´
ìš©ë„: ëŒ€ê·œëª¨ ì¡°ì§ì—ì„œ íŒ€ë³„ ë…ë¦½ GraphQL ì„œë¹„ìŠ¤ í†µí•©
ì˜ˆì‹œ: Apollo Router, Apollo Gateway

ì•„í‚¤í…ì²˜ ë¹„êµ
Case A: REST Gateway + REST Services
Client 
  â†’ REST Gateway (FastAPI)
    â†’ Robot Service (REST)
    â†’ Telemetry Service (REST)
    â†’ Alert Service (REST)
íŠ¹ì§•:

Gatewayì—ì„œ N+1 ìˆ˜ë™ í•´ê²° í•„ìš”
í´ë¼ì´ì–¸íŠ¸ëŠ” í•­ìƒ ê³ ì •ëœ ì‘ë‹µ ë°›ìŒ


Case B: GraphQL Server + REST Services (â˜… ì¶”ì²œ)
Client 
  â†’ GraphQL Server (Strawberry or Apollo Server)
    â†’ Robot Service (REST)
    â†’ Telemetry Service (REST)
    â†’ Alert Service (REST)
íŠ¹ì§•:

DataLoaderë¡œ N+1 ìë™ í•´ê²°
í´ë¼ì´ì–¸íŠ¸ê°€ í•„ìš”í•œ í•„ë“œë§Œ ìš”ì²­ ê°€ëŠ¥
ì„œë²„ 1ê°œë¡œ ëª¨ë“  íƒ€ì… ê´€ë¦¬


Case C: GraphQL Federation
Client 
  â†’ Apollo Router
    â†’ Robot Subgraph (Apollo Server)
      â†’ Robot Service (REST)
    â†’ Telemetry Subgraph (Apollo Server)
      â†’ Telemetry Service (REST)
    â†’ Alert Subgraph (Apollo Server)
      â†’ Alert Service (REST)
íŠ¹ì§•:

ê° Subgraphê°€ ë…ë¦½ì ì¸ GraphQL ì„œë²„
Routerê°€ ì¿¼ë¦¬ë¥¼ ë¶„í•´í•´ì„œ ê° Subgraphë¡œ ë¼ìš°íŒ…
íŒ€ë³„ ìŠ¤í‚¤ë§ˆ ë…ë¦½ ê´€ë¦¬ ê°€ëŠ¥
ë³µì¡ë„ ë§¤ìš° ë†’ìŒ


ë‚´ë¶€ í˜¸ì¶œ íë¦„ ë¹„êµ
í”Œë¦¿ ëŒ€ì‹œë³´ë“œ ì¡°íšŒ (15ëŒ€ ë¡œë´‡)
Case A: REST Gateway
Client â†’ GET /api/fleet/dashboard

Gateway ë‚´ë¶€:
  â†’ GET /robots (1ë²ˆ)
  â†’ GET /robots/1/telemetry (1ë²ˆ)
  â†’ GET /robots/2/telemetry (1ë²ˆ)
  â†’ ... (15ë²ˆ)
  â†’ GET /robots/1/alerts (1ë²ˆ)
  â†’ GET /robots/2/alerts (1ë²ˆ)
  â†’ ... (15ë²ˆ)

ì´ ë‚´ë¶€ í˜¸ì¶œ: 31ë²ˆ

Case B: GraphQL Server + DataLoader
Client â†’ POST /graphql (query { fleetDashboard { robots { telemetry alerts } } })

GraphQL Server ë‚´ë¶€:
  â†’ GET /robots (1ë²ˆ)
  â†’ DataLoaderê°€ telemetry ìš”ì²­ 15ê°œ ìˆ˜ì§‘
    â†’ POST /telemetry/batch (1ë²ˆ, robot_ids=[1,2,...,15])
  â†’ DataLoaderê°€ alerts ìš”ì²­ 15ê°œ ìˆ˜ì§‘
    â†’ POST /alerts/batch (1ë²ˆ, robot_ids=[1,2,...,15])

ì´ ë‚´ë¶€ í˜¸ì¶œ: 3ë²ˆ

Case C: GraphQL Federation
Client â†’ POST /graphql (query { fleetDashboard { robots { telemetry alerts } } })

Apollo Router ë‚´ë¶€:
  1. ì¿¼ë¦¬ ë¶„ì„
  2. Subgraphë³„ ì¿¼ë¦¬ ìƒì„±
  
  â†’ Robot Subgraph: query { robots { id name } }
    Robot Subgraph ë‚´ë¶€:
      â†’ GET /robots (1ë²ˆ)
  
  â†’ Telemetry Subgraph: query { _entities(representations: [...]) { telemetry } }
    Telemetry Subgraph ë‚´ë¶€:
      â†’ POST /telemetry/batch (1ë²ˆ)
  
  â†’ Alert Subgraph: query { _entities(representations: [...]) { alerts } }
    Alert Subgraph ë‚´ë¶€:
      â†’ POST /alerts/batch (1ë²ˆ)
  
  3. ì‘ë‹µ ë³‘í•©

ì´ ë‚´ë¶€ í˜¸ì¶œ: 3ë²ˆ (í•˜ì§€ë§Œ GraphQL ì„œë²„ 3ê°œ í•„ìš”)

ì†”ë£¨ì…˜ë³„ ì¥ë‹¨ì 
REST Gateway
ì¥ì :

ë‹¨ìˆœí•¨
ë ˆê±°ì‹œ í†µí•© ì‰¬ì›€

ë‹¨ì :

N+1 ìˆ˜ë™ í•´ê²°
Over-fetching ë¶ˆê°€í”¼
í´ë¼ì´ì–¸íŠ¸ê°€ ì—¬ëŸ¬ ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ í•„ìš”


GraphQL Server (Strawberry/Apollo Server)
ì¥ì :

N+1 ìë™ í•´ê²°
ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸
í´ë¼ì´ì–¸íŠ¸ ìœ ì—°ì„±
ì„œë²„ 1ê°œë¡œ ì¶©ë¶„

ë‹¨ì :

GraphQL ëŸ¬ë‹ì»¤ë¸Œ
REST ëŒ€ë¹„ ë³µì¡ë„ ì¦ê°€


GraphQL Federation
ì¥ì :

íŒ€ë³„ ë…ë¦½ ê°œë°œ
ìŠ¤í‚¤ë§ˆ ìë™ í†µí•©
ëŒ€ê·œëª¨ í™•ì¥ì„±

ë‹¨ì :

ë§¤ìš° ë†’ì€ ë³µì¡ë„
ìš´ì˜ ë¶€ë‹´ (ì„œë²„ N+1ê°œ)
ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ GraphQLë¡œ ë³€í™˜ í•„ìš”
ì†Œê·œëª¨ í”„ë¡œì íŠ¸ì— ê³¼ì‰


ì„ íƒ ê°€ì´ë“œ
ìƒí™©ì¶”ì²œ ì†”ë£¨ì…˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ REST, ë‹¨ì¼ íŒ€GraphQL Server (Strawberry)ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ REST, ë‹¨ìˆœ í”„ë¡ì‹œë§Œ í•„ìš”REST Gatewayë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°€ GraphQL, ì—¬ëŸ¬ íŒ€GraphQL Federationì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ëª©ì REST Gateway + GraphQL Server ë¹„êµ

ìš°ë¦¬ í”„ë¡œì íŠ¸ ìµœì¢… êµ¬ì¡°
Performance Test:

Client
  â†’ REST Endpoint (/api/rest/*)
    â†’ Robot Service (REST)
    â†’ Telemetry Service (REST)
    â†’ Alert Service (REST)

Client
  â†’ GraphQL Endpoint (/graphql)
    â†’ Robot Service (REST)
    â†’ Telemetry Service (REST)
    â†’ Alert Service (REST)

ë¹„êµ í¬ì¸íŠ¸:
- REST: 31ë²ˆ ë‚´ë¶€ í˜¸ì¶œ
- GraphQL: 3ë²ˆ ë‚´ë¶€ í˜¸ì¶œ (DataLoader)

ì´ì œ ëª…í™•í•´? Federationì€ ìš°ë¦¬í•œí…Œ ì™„ì „íˆ ë¶ˆí•„ìš”í•˜ê³ , Strawberry vs REST Gateway ë¹„êµë§Œ í•˜ë©´ ë¼!ê·¸ëŸ¼ ì € ê¸°ì¤€ìœ¼ë¡œ ì•„í‚¤í…ì³ë¥¼ ë‘ë²Œë§Œë“¤ê³ , ê°ê° ë„ì»¤ë“¤ì„ ë‹¤ ë„ì–´ì•¼ê² ì§€? ê·¼ë° ë’·ë‹¨ì´ ë‹¤ ë ˆìŠ¤íŠ¸ì„œë²„ì¸ê±°ë©´ ê³µìš©ìœ¼ë¡œ ì‚¬ìš©í•´ë„ ë˜ì§€ ì•Šì•„? ì•ë‹¨ì´ ë‹¤ë¥¸ê±°ì§€?2ì›” 4ì¼ì™„ì „ ì •í™•í•´! ë’·ë‹¨ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ëŠ” ê³µìš©ìœ¼ë¡œ ì“°ë©´ ë¼.

ì•„í‚¤í…ì²˜ êµ¬ì„±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Performance Test Client             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REST Gateway    â”‚  â”‚ GraphQL Gateway  â”‚
â”‚  (FastAPI)       â”‚  â”‚ (Strawberry)     â”‚
â”‚  Port 8000       â”‚  â”‚ Port 8100        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   ê³µìš© ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤   â”‚
        â”‚                       â”‚
        â”‚  Robot Service :8001  â”‚
        â”‚  Telemetry Service    â”‚
        â”‚  :8002                â”‚
        â”‚  Alert Service :8003  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      PostgreSQL       â”‚
        â”‚         :5432         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Docker Compose êµ¬ì„±
í•„ìš”í•œ ì»¨í…Œì´ë„ˆ (ì´ 6ê°œ)

rest-gateway (Port 8000)
graphql-gateway (Port 8100)
robot-service (Port 8001) â† ê³µìš©
telemetry-service (Port 8002) â† ê³µìš©
alert-service (Port 8003) â† ê³µìš©
postgres (Port 5432) â† ê³µìš©


í˜¸ì¶œ íë¦„
REST í…ŒìŠ¤íŠ¸
Client 
  â†’ http://localhost:8000/api/fleet/dashboard
    â†’ http://robot-service:8001/robots
    â†’ http://telemetry-service:8002/robots/1/latest
    â†’ http://telemetry-service:8002/robots/2/latest
    â†’ ...
GraphQL í…ŒìŠ¤íŠ¸
Client 
  â†’ http://localhost:8100/graphql
    â†’ http://robot-service:8001/robots
    â†’ http://telemetry-service:8002/batch-query (robot_ids=[1,2,...])
    â†’ http://alert-service:8003/batch-query (robot_ids=[1,2,...])
ë’·ë‹¨ ì„œë¹„ìŠ¤ëŠ” ë™ì¼í•˜ê²Œ í˜¸ì¶œë¨!

í•µì‹¬ í¬ì¸íŠ¸
ê³µìš©ìœ¼ë¡œ ì“°ëŠ” ì´ìœ 
âœ… REST ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ëŠ” HTTP APIë§Œ ì œê³µ (ëˆ„ê°€ í˜¸ì¶œí•˜ë“  ìƒê´€ì—†ìŒ)
âœ… ì„±ëŠ¥ ë¹„êµê°€ ê³µì •í•¨ (ê°™ì€ ë’·ë‹¨ í˜¸ì¶œ)
âœ… ë¦¬ì†ŒìŠ¤ ì ˆì•½ (ì¤‘ë³µ ì»¨í…Œì´ë„ˆ ë¶ˆí•„ìš”)
âœ… ë°ì´í„°ë² ì´ìŠ¤ë„ ê³µìœ  (ë™ì¼í•œ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸)
ë¶„ë¦¬í•˜ëŠ” ê²ƒ
âœ… REST Gatewayì™€ GraphQL Gatewayë§Œ ë³„ë„ ì»¨í…Œì´ë„ˆ
âœ… ê°ì ë‹¤ë¥¸ í¬íŠ¸ë¡œ ë¦¬ìŠ¤ë‹
âœ… ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹œ ê°ê° ì¸¡ì •

ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ìš”êµ¬ì‚¬í•­
ë’·ë‹¨ ì„œë¹„ìŠ¤ë“¤ì´ ë°°ì¹˜ ì¡°íšŒ APIë¥¼ ì œê³µí•´ì•¼ í•¨:
Robot Service
GET /robots          # ì „ì²´ ëª©ë¡
GET /robots/{id}     # ë‹¨ê±´ ì¡°íšŒ
Telemetry Service
GET /telemetry/robots/{id}/latest      # ë‹¨ê±´ ì¡°íšŒ
POST /telemetry/batch-query            # ë°°ì¹˜ ì¡°íšŒ (GraphQLìš©)
  Body: { "robot_ids": ["1", "2", ...] }
Alert Service
GET /alerts/robots/{id}     # ë‹¨ê±´ ì¡°íšŒ
POST /alerts/batch-query    # ë°°ì¹˜ ì¡°íšŒ (GraphQLìš©)
  Body: { "robot_ids": ["1", "2", ...] }
REST GatewayëŠ” ë‹¨ê±´ APIë§Œ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œ
GraphQL GatewayëŠ” ë°°ì¹˜ API í•œë²ˆë§Œ í˜¸ì¶œ

ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ë°©ì‹
ë™ì‹œì— ë‘ Gateway í…ŒìŠ¤íŠ¸
bash# REST Gateway ë¶€í•˜ í…ŒìŠ¤íŠ¸
locust -f test_rest.py --host=http://localhost:8000

# GraphQL Gateway ë¶€í•˜ í…ŒìŠ¤íŠ¸ (ë³„ë„ í„°ë¯¸ë„)
locust -f test_graphql.py --host=http://localhost:8100
ì¸¡ì • í•­ëª©

ì‘ë‹µ ì‹œê°„ (REST vs GraphQL)
ë’·ë‹¨ ì„œë¹„ìŠ¤ í˜¸ì¶œ íšŸìˆ˜ (ì¤‘ìš”!)
ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½
CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰


ì¶”ê°€ ê³ ë ¤ì‚¬í•­
ê´€ì°° ê°€ëŠ¥ì„± (Observability)
ê³µìš© ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì— ë¡œê¹… ì¶”ê°€í•˜ë©´:
python@app.get("/robots/{id}")
async def get_robot(id: str):
    logger.info(f"Called by: {request.headers.get('X-Gateway-Type')}")  # REST or GraphQL
    return robot_data
ì´ë ‡ê²Œ í•˜ë©´ ì–´ëŠ Gatewayì—ì„œ ì–¼ë§ˆë‚˜ í˜¸ì¶œí–ˆëŠ”ì§€ ì¶”ì  ê°€ëŠ¥!

ìµœì¢… í™•ì¸
ë„¤ ë§ì´ 100% ë§ì•„:

âœ… ë’·ë‹¨ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ëŠ” ê³µìš©
âœ… Gatewayë§Œ ë‘ ë²Œ (REST, GraphQL)
âœ… ë°ì´í„°ë² ì´ìŠ¤ë„ ê³µìš©
âœ… ì„±ëŠ¥ ë¹„êµëŠ” Gateway ë ˆë²¨ì—ì„œ

Docker Compose ì‹œì‘í•˜ë©´:
bashdocker-compose up

Running containers:
- rest-gateway (8000)
- graphql-gateway (8100)
- robot-service (8001) â† ê³µìš©
- telemetry-service (8002) â† ê³µìš©
- alert-service (8003) â† ê³µìš©
- postgres (5432) â† ê³µìš©
ì´ êµ¬ì¡°ë¡œ ê°ˆê¹Œ?

** User **
ê·¸ëŸ¼ ì¢€ ê³µí‰í•˜ê²Œ ë ˆìŠ¤íŠ¸ ê²Œì´íŠ¸ì›¨ì´ê°€  ì½©ê²Œì´íŠ¸ì›¨ì´ ê·¸ëŸ°ê±° ì¨ì•¼í•˜ëŠ”ê±° ì•„ë‹ˆì•¼?

** AI System **
ì•„ ì¢‹ì€ ì§€ì ì´ì•¼! ê³µì •í•œ ë¹„êµë¥¼ ìœ„í•œ ê³ ë¯¼ì´ë„¤.


ê³µí‰ì„± ì´ìŠˆ
í˜„ì¬ ì„¤ê³„
REST Gateway: FastAPI (Python)
GraphQL Gateway: Strawberry + FastAPI (Python)
ë¬¸ì œì :

ë‘˜ ë‹¤ FastAPI ê¸°ë°˜ì´ë©´ â†’ ê³µí‰í•¨ âœ…
í•˜ì§€ë§Œ "Gateway ì œí’ˆ" ë¹„êµ ì•„ë‹Œê°€?


ì„ íƒì§€
Option 1: ë‘˜ ë‹¤ FastAPI (í˜„ì¬)
REST Gateway: FastAPIë¡œ ì§ì ‘ êµ¬í˜„
GraphQL Gateway: Strawberry + FastAPI
ê³µí‰í•œê°€?

âœ… ê°™ì€ ì–¸ì–´/í”„ë ˆì„ì›Œí¬
âœ… ìˆœìˆ˜í•˜ê²Œ REST vs GraphQL í”„ë¡œí† ì½œ ë¹„êµ
âŒ í”„ë¡œë•ì…˜ê¸‰ Gateway ê¸°ëŠ¥ ë¶€ì¡±


Option 2: ì „ë¬¸ Gateway ì œí’ˆ ì‚¬ìš©
REST Gateway: Kong / Nginx / Traefik
GraphQL Gateway: Apollo Server / Strawberry
ë¬¸ì œì :

Kongì€ C/Lua ê¸°ë°˜
ApolloëŠ” Node.js ê¸°ë°˜
StrawberryëŠ” Python ê¸°ë°˜
ì–¸ì–´/ëŸ°íƒ€ì„ì´ ë‹¬ë¼ì„œ ë¶ˆê³µí‰ âŒ


Option 3: ì–¸ì–´ í†µì¼ (ì¶”ì²œ â­)
REST Gateway: FastAPI (ì§ì ‘ êµ¬í˜„)
GraphQL Gateway: Strawberry + FastAPI (ì§ì ‘ êµ¬í˜„)
ì´ê²Œ ê°€ì¥ ê³µí‰í•œ ì´ìœ :

ê°™ì€ ì–¸ì–´/ëŸ°íƒ€ì„
ê°™ì€ HTTP ì„œë²„ (uvicorn)
ìˆœìˆ˜í•˜ê²Œ REST API í˜¸ì¶œ ë°©ì‹ vs GraphQL DataLoader ë¹„êµ


ë„¤ê°€ ë§í•œ Kong ê°™ì€ ê±¸ ì“´ë‹¤ë©´?
Kong Gateway ì¶”ê°€ ì‹œ
REST Gateway: Kong (C/Lua, ì—”í„°í”„ë¼ì´ì¦ˆê¸‰)
  - Rate limiting
  - Load balancing
  - Service mesh
  - í”ŒëŸ¬ê·¸ì¸ ìƒíƒœê³„

GraphQL Gateway: Strawberry (Python, ì§ì ‘ êµ¬í˜„)
  - DataLoaderë§Œ ìˆìŒ
ë¬¸ì œ:

Kongì´ ë„ˆë¬´ ë¬´ê±°ì›€
ê¸°ëŠ¥ì´ ë„ˆë¬´ ë§ì•„ì„œ ë¹„êµ ì´ˆì  íë ¤ì§
ìš°ë¦¬ê°€ ë¹„êµí•˜ë ¤ëŠ” ê±´: N+1 í•´ê²° ëŠ¥ë ¥


ê³µì •í•œ ë¹„êµë¥¼ ìœ„í•œ ì›ì¹™
ìš°ë¦¬ê°€ í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ê²ƒ
REST ë°©ì‹ì˜ N+1 ë¬¸ì œ 
vs 
GraphQL DataLoaderì˜ ë°°ì¹˜ ì²˜ë¦¬
ë³€ìˆ˜ í†µì œ
ìš”ì†ŒRESTGraphQLí†µì œ ì—¬ë¶€ì–¸ì–´PythonPythonâœ… ë™ì¼í”„ë ˆì„ì›Œí¬FastAPIFastAPIâœ… ë™ì¼HTTP ì„œë²„uvicornuvicornâœ… ë™ì¼ë°ì´í„°ë² ì´ìŠ¤PostgreSQLPostgreSQLâœ… ë™ì¼ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê³µìš©ê³µìš©âœ… ë™ì¼ì°¨ì´ì ë°˜ë³µ í˜¸ì¶œDataLoaderğŸ¯ ì¸¡ì • ëŒ€ìƒ

ë§Œì•½ Kongì„ ì“´ë‹¤ë©´
ê³µì •í•˜ê²Œ ë§Œë“¤ë ¤ë©´
REST Gateway: Kong
GraphQL Gateway: Apollo Router (ì—”í„°í”„ë¼ì´ì¦ˆê¸‰)
í•˜ì§€ë§Œ:

Apollo RouterëŠ” Federationìš© (ìš°ë¦¬ êµ¬ì¡°ì— ì•ˆ ë§ìŒ)
Kong + Apollo Server ì¡°í•©? (ë„ˆë¬´ ë³µì¡)
ê²°êµ­ FastAPI ìˆ˜ì¤€ìœ¼ë¡œ ë‹¨ìˆœí™”í•´ì•¼ ë¹„êµ ê°€ëŠ¥


ìµœì¢… ì¶”ì²œ
ê³µì •í•œ ë¹„êµ êµ¬ì¡°
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Performance Test Client             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REST Gateway    â”‚  â”‚ GraphQL Gateway  â”‚
â”‚                  â”‚  â”‚                  â”‚
â”‚  FastAPI         â”‚  â”‚  Strawberry      â”‚
â”‚  + uvicorn       â”‚  â”‚  + FastAPI       â”‚
â”‚                  â”‚  â”‚  + uvicorn       â”‚
â”‚  ìˆ˜ë™ ë°°ì¹˜ì²˜ë¦¬    â”‚  â”‚  DataLoader      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
í•µì‹¬:

ë‘˜ ë‹¤ FastAPI ê¸°ë°˜
REST Gatewayë„ ìµœì í™”ëœ ì½”ë“œ ì‘ì„± (ë°°ì¹˜ API í™œìš©)
ìˆœìˆ˜í•˜ê²Œ í˜¸ì¶œ íŒ¨í„´ì˜ ì°¨ì´ë§Œ ë¹„êµ


REST Gateway ìµœì í™” ë²„ì „
ìˆœì§„í•œ REST (Naive)
python# N+1 ë¬¸ì œ ê·¸ëŒ€ë¡œ
for robot in robots:
    telemetry = await get(f"/robots/{robot.id}/telemetry")
ìµœì í™”ëœ REST (Optimized)
python# ë°°ì¹˜ API í™œìš©
robot_ids = [r.id for r in robots]
telemetry_map = await post("/telemetry/batch-query", json={"robot_ids": robot_ids})
```

**ì´ë ‡ê²Œ í•˜ë©´:**
- RESTë„ 3ë²ˆ í˜¸ì¶œ ê°€ëŠ¥
- GraphQLê³¼ ë™ì¼í•œ ì„±ëŠ¥
- **ê·¸ëŸ¼ GraphQLì˜ ì¥ì ì´ ë­ëƒ?** â†’ ìë™í™”!

---

## ë¹„êµ ì‹œë‚˜ë¦¬ì˜¤

### Test 1: ìˆœì§„í•œ êµ¬í˜„
```
REST (Naive): 31ë²ˆ í˜¸ì¶œ
GraphQL (DataLoader): 3ë²ˆ í˜¸ì¶œ

ê²°ê³¼: GraphQL 10ë°° ë¹ ë¦„
```

### Test 2: ë‘˜ ë‹¤ ìµœì í™”
```
REST (Optimized): 3ë²ˆ í˜¸ì¶œ (ìˆ˜ë™ ë°°ì¹˜)
GraphQL (DataLoader): 3ë²ˆ í˜¸ì¶œ (ìë™ ë°°ì¹˜)

ê²°ê³¼: ì„±ëŠ¥ ë¹„ìŠ·, í•˜ì§€ë§Œ GraphQLì´ ì½”ë“œ ê°„ê²°
```

---

## ê²°ë¡ 

### ê³µì •í•œ ë¹„êµë¥¼ ìœ„í•´:

**âœ… ì¶”ì²œ: ë‘˜ ë‹¤ FastAPI**
- ì–¸ì–´/ëŸ°íƒ€ì„ í†µì¼
- ìˆœìˆ˜ í”„ë¡œí† ì½œ ë¹„êµ
- ë‘ ê°€ì§€ REST ë²„ì „ í…ŒìŠ¤íŠ¸
  1. Naive REST (ë°˜ë³µ í˜¸ì¶œ)
  2. Optimized REST (ë°°ì¹˜ API)
  3. GraphQL (DataLoader)

**âŒ ë¹„ì¶”ì²œ: Kong ê°™ì€ ì „ë¬¸ Gateway**
- ë³€ìˆ˜ ë„ˆë¬´ ë§ì•„ì§
- ë¹„êµ ì´ˆì  íë ¤ì§
- ì˜¤ë²„ì—”ì§€ë‹ˆì–´ë§

---

### ìµœì¢… í…ŒìŠ¤íŠ¸ êµ¬ì¡°
```
Client
  â†’ REST Naive (FastAPI) - 31ë²ˆ í˜¸ì¶œ
  â†’ REST Optimized (FastAPI) - 3ë²ˆ í˜¸ì¶œ (ìˆ˜ë™)
  â†’ GraphQL (Strawberry) - 3ë²ˆ í˜¸ì¶œ (ìë™)

ì¸¡ì •:
- ì„±ëŠ¥ (ì‘ë‹µ ì‹œê°„)
- ì½”ë“œ ë³µì¡ë„
- ìœ ì§€ë³´ìˆ˜ì„±
ì´ë ‡ê²Œ ê°€ëŠ” ê²Œ ì–´ë•Œ? Kongì€ ë‚˜ì¤‘ì— í”„ë¡œë•ì…˜ ì ìš©í•  ë•Œ ê³ ë ¤í•˜ê³ !

** User **
ê·¸ê·¸ë˜ ê·¸ëŸ¼ ë‹¤ì‹œ í•œë²ˆ ì •ë¦¬í•´ì¤˜ë´

** AI System **
ì¢‹ì•„, ì „ì²´ë¥¼ ê¹”ë”í•˜ê²Œ ì •ë¦¬í•´ì¤„ê²Œ.

í”„ë¡œì íŠ¸ ëª©í‘œ
REST vs GraphQL ì„±ëŠ¥ ë¹„êµ

ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í™˜ê²½ì—ì„œ N+1 ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ ë¹„êµ
ë‚´ë¶€ ì„œë¹„ìŠ¤ í˜¸ì¶œ íšŸìˆ˜ ë° ì‘ë‹µ ì‹œê°„ ì¸¡ì •


ì „ì²´ ì•„í‚¤í…ì²˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Performance Test Client             â”‚
â”‚              (Locust / k6)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚              â”‚
         â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ REST Naive   â”‚ â”‚ REST         â”‚ â”‚ GraphQL      â”‚
â”‚              â”‚ â”‚ Optimized    â”‚ â”‚              â”‚
â”‚ FastAPI      â”‚ â”‚ FastAPI      â”‚ â”‚ Strawberry   â”‚
â”‚ :8000        â”‚ â”‚ :8001        â”‚ â”‚ + FastAPI    â”‚
â”‚              â”‚ â”‚              â”‚ â”‚ :8100        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   ê³µìš© ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤   â”‚
            â”‚                       â”‚
            â”‚  Robot Service :8001  â”‚
            â”‚  Telemetry Service    â”‚
            â”‚  :8002                â”‚
            â”‚  Alert Service :8003  â”‚
            â”‚                       â”‚
            â”‚  (ëª¨ë‘ FastAPI REST)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚      PostgreSQL       â”‚
            â”‚         :5432         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ êµ¬ì„± (ê³µìš©)
1. Robot Service (:8001)
ì—­í• : ë¡œë´‡ ë©”íƒ€ë°ì´í„° ê´€ë¦¬
API:
GET  /robots           - ì „ì²´ ë¡œë´‡ ëª©ë¡
GET  /robots/{id}      - ë¡œë´‡ ë‹¨ê±´ ì¡°íšŒ
ë°ì´í„°:
- id: ë¡œë´‡ ID
- name: ë¡œë´‡ ì´ë¦„
- model: ëª¨ë¸ëª…
- location: ìœ„ì¹˜
- status: ìƒíƒœ

2. Telemetry Service (:8002)
ì—­í• : ì„¼ì„œ ë°ì´í„° ë° ë©”íŠ¸ë¦­
API:
GET  /telemetry/robots/{id}/latest     - ë‹¨ê±´ ì¡°íšŒ
POST /telemetry/batch-query            - ë°°ì¹˜ ì¡°íšŒ
     Body: {"robot_ids": ["1", "2"]}
ë°ì´í„°:
- robot_id: ë¡œë´‡ ID
- battery_level: ë°°í„°ë¦¬
- cpu_usage: CPU ì‚¬ìš©ë¥ 
- temperature: ì˜¨ë„
- timestamp: ì‹œê°„

3. Alert Service (:8003)
ì—­í• : ì•ŒëŒ ë° ì´ë²¤íŠ¸ ê´€ë¦¬
API:
GET  /alerts/robots/{id}               - ë‹¨ê±´ ì¡°íšŒ
POST /alerts/batch-query               - ë°°ì¹˜ ì¡°íšŒ
     Body: {"robot_ids": ["1", "2"]}
ë°ì´í„°:
- id: ì•ŒëŒ ID
- robot_id: ë¡œë´‡ ID
- type: ì•ŒëŒ íƒ€ì…
- severity: ì‹¬ê°ë„
- message: ë©”ì‹œì§€

Gateway êµ¬ì„± (3ê°œ ë²„ì „)
1. REST Gateway - Naive (:8000)
êµ¬í˜„ ë°©ì‹: ìˆœì§„í•œ ë°˜ë³µ í˜¸ì¶œ
í”Œë¦¿ ëŒ€ì‹œë³´ë“œ ë‚´ë¶€ ë¡œì§:
1. GET /robots (1ë²ˆ)
2. for each robot (15ëŒ€):
     - GET /telemetry/robots/{id}/latest (15ë²ˆ)
     - GET /alerts/robots/{id} (15ë²ˆ)

ì´ 31ë²ˆ í˜¸ì¶œ
ëª©ì : ë² ì´ìŠ¤ë¼ì¸, ìµœì•…ì˜ ê²½ìš°

2. REST Gateway - Optimized (:8001)
êµ¬í˜„ ë°©ì‹: ìˆ˜ë™ ë°°ì¹˜ ì²˜ë¦¬
í”Œë¦¿ ëŒ€ì‹œë³´ë“œ ë‚´ë¶€ ë¡œì§:
1. GET /robots (1ë²ˆ)
2. robot_ids ì¶”ì¶œ
3. POST /telemetry/batch-query (1ë²ˆ)
4. POST /alerts/batch-query (1ë²ˆ)

ì´ 3ë²ˆ í˜¸ì¶œ
ëª©ì : RESTë„ ìµœì í™”í•˜ë©´ ë¹ ë¥¼ ìˆ˜ ìˆë‹¤ëŠ” ì¦ëª…

3. GraphQL Gateway (:8100)
êµ¬í˜„ ë°©ì‹: DataLoader ìë™ ë°°ì¹˜
í”Œë¦¿ ëŒ€ì‹œë³´ë“œ ë‚´ë¶€ ë¡œì§:
1. GET /robots (1ë²ˆ)
2. DataLoaderê°€ telemetry ìš”ì²­ ìë™ ìˆ˜ì§‘
   â†’ POST /telemetry/batch-query (1ë²ˆ)
3. DataLoaderê°€ alerts ìš”ì²­ ìë™ ìˆ˜ì§‘
   â†’ POST /alerts/batch-query (1ë²ˆ)

ì´ 3ë²ˆ í˜¸ì¶œ (ìë™)
ëª©ì : GraphQLì˜ ìë™ ìµœì í™” ëŠ¥ë ¥

í´ë¼ì´ì–¸íŠ¸ API (3ê°œ)
1. í”Œë¦¿ ëŒ€ì‹œë³´ë“œ
ëª©ì : N+1 ë¬¸ì œ ê·¹ëŒ€í™”
ìš”ì²­:
REST: GET /api/fleet/dashboard
GraphQL: query { fleetDashboard { robots { name latestTelemetry { battery } activeAlerts { message } } } }
ì‘ë‹µ ë°ì´í„°:

15ëŒ€ ë¡œë´‡ ì •ë³´
ê° ë¡œë´‡ì˜ ìµœì‹  í…”ë ˆë©”íŠ¸ë¦¬
ê° ë¡œë´‡ì˜ í™œì„± ì•ŒëŒ

ë‚´ë¶€ í˜¸ì¶œ:
REST Naive: 31ë²ˆ
REST Optimized: 3ë²ˆ
GraphQL: 3ë²ˆ

2. ë¡œë´‡ ìƒì„¸ ëª¨ë‹ˆí„°ë§
ëª©ì : 1:1 ê´€ê³„ (N+1 ì—†ìŒ)
ìš”ì²­:
REST: GET /api/robots/{id}/monitor
GraphQL: query { robot(id: "123") { name latestTelemetry { battery } recentAlerts { message } } }
ì‘ë‹µ ë°ì´í„°:

ë¡œë´‡ ê¸°ë³¸ ì •ë³´
ìµœì‹  í…”ë ˆë©”íŠ¸ë¦¬
ìµœê·¼ ì•ŒëŒ 5ê°œ

ë‚´ë¶€ í˜¸ì¶œ:
REST Naive: 3ë²ˆ
REST Optimized: 3ë²ˆ
GraphQL: 3ë²ˆ
ì°¨ì´: ì—†ìŒ (ê³µì •í•œ ë¹„êµ)

3. í¬ë¦¬í‹°ì»¬ ì•ŒëŒ ì¡°íšŒ
ëª©ì : N+1 ë¬¸ì œ ë°œìƒ
ìš”ì²­:
REST: GET /api/alerts/critical
GraphQL: query { criticalAlerts { message robot { name } telemetrySnapshot { battery } } }
ì‘ë‹µ ë°ì´í„°:

ì‹¬ê°ë„ critical ì•ŒëŒ 10ê°œ
ê° ì•ŒëŒì˜ ë¡œë´‡ ì •ë³´
ë°œìƒ ì‹œì  í…”ë ˆë©”íŠ¸ë¦¬

ë‚´ë¶€ í˜¸ì¶œ:
REST Naive: 21ë²ˆ (1 + 10 + 10)
REST Optimized: 3ë²ˆ
GraphQL: 3ë²ˆ

Docker Compose êµ¬ì„±
ì»¨í…Œì´ë„ˆ ëª©ë¡ (ì´ 7ê°œ):
1. rest-naive-gateway     (Port 8000)
2. rest-optimized-gateway (Port 8001)
3. graphql-gateway        (Port 8100)
4. robot-service          (Port 8001) - ê³µìš©
5. telemetry-service      (Port 8002) - ê³µìš©
6. alert-service          (Port 8003) - ê³µìš©
7. postgres               (Port 5432) - ê³µìš©

ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
sql-- robots
id, name, model, location, status, created_at

-- telemetry_data
id, robot_id, timestamp, battery_level, cpu_usage, temperature

-- alerts
id, robot_id, type, severity, message, status, created_at
```

**ì´ˆê¸° ë°ì´í„°:**
- ë¡œë´‡ 15ëŒ€
- ê° ë¡œë´‡ë‹¹ í…”ë ˆë©”íŠ¸ë¦¬ 100ê°œ (ì‹œê³„ì—´)
- ê° ë¡œë´‡ë‹¹ ì•ŒëŒ 5~10ê°œ

---

## ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### í…ŒìŠ¤íŠ¸ ë„êµ¬
- Locust ë˜ëŠ” k6

### í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤
**1. ë™ì‹œ ì‚¬ìš©ì 100ëª…**
- í”Œë¦¿ ëŒ€ì‹œë³´ë“œ ë°˜ë³µ ì¡°íšŒ
- 30ì´ˆê°„ ì§€ì†

**2. ì¸¡ì • í•­ëª©**
- ì‘ë‹µ ì‹œê°„ (í‰ê· , P95, P99)
- ì²˜ë¦¬ëŸ‰ (RPS)
- **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í˜¸ì¶œ íšŸìˆ˜** (ì¤‘ìš”!)
- CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

**3. ë¹„êµ ëŒ€ìƒ**
```
REST Naive vs REST Optimized vs GraphQL
```

---

## ì˜ˆìƒ ê²°ê³¼

### ì‘ë‹µ ì‹œê°„ (ì˜ˆì¸¡)
```
REST Naive:      ~500ms (31ë²ˆ í˜¸ì¶œ)
REST Optimized:  ~100ms (3ë²ˆ í˜¸ì¶œ)
GraphQL:         ~100ms (3ë²ˆ í˜¸ì¶œ)
```

### ì½”ë“œ ë³µì¡ë„
```
REST Naive:      ê°„ë‹¨ (ë¹„íš¨ìœ¨)
REST Optimized:  ë³µì¡ (ìˆ˜ë™ ë°°ì¹˜ ë¡œì§)
GraphQL:         ê°„ë‹¨ (DataLoader ìë™)
ê²°ë¡ 

ì„±ëŠ¥: Optimized REST â‰ˆ GraphQL
ìƒì‚°ì„±: GraphQL > REST (ìë™í™”)
ìœ ì§€ë³´ìˆ˜: GraphQL > REST (ì„ ì–¸ì )


ê¸°ìˆ  ìŠ¤íƒ ì •ë¦¬
ê³„ì¸µREST NaiveREST OptimizedGraphQLë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì–¸ì–´PythonPythonPythonPythoní”„ë ˆì„ì›Œí¬FastAPIFastAPIFastAPIFastAPIHTTP ì„œë²„uvicornuvicornuvicornuvicornGraphQL--Strawberry-ë°ì´í„°ë² ì´ìŠ¤---PostgreSQLORM---SQLAlchemy

êµ¬í˜„ ìˆœì„œ
Phase 1: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤

Robot Service
Telemetry Service (+ ë°°ì¹˜ API)
Alert Service (+ ë°°ì¹˜ API)
ì´ˆê¸° ë°ì´í„° ì„¸íŒ…

Phase 2: Gateway

REST Naive Gateway
REST Optimized Gateway
GraphQL Gateway (Strawberry + DataLoader)

Phase 3: í…ŒìŠ¤íŠ¸

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (ê° API ê²€ì¦)
í†µí•© í…ŒìŠ¤íŠ¸ (ì „ì²´ í”Œë¡œìš°)
ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (Locust)
ê²°ê³¼ ë¶„ì„ ë° ë¦¬í¬íŠ¸